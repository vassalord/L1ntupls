#define HBStudy_plotByQIE_cxx
#include "HBStudy_plotByQIE.h"
#include <TH2.h>
#include <TF1.h>
#include <TStyle.h>
#include <TCanvas.h>
#include <TEfficiency.h>
#include <TFile.h>
#include <TTree.h>
#include <TBranch.h>
#include <TChain.h>
#include <TGraph.h>
#include <TGraphAsymmErrors.h>
#include <TLatex.h>
#include <THStack.h>

#include <fstream>
#include <sstream>
#include <iostream>
#include <vector>

void HBStudy_plotByQIE::Loop()
{
  //   In a ROOT session, you can do:
  //      root> .L HBStudy_plotByQIE.C
  //      root> HBStudy_plotByQIE t
  //      root> t.GetEntry(12); // Fill t data members with entry number 12
  //      root> t.Show();       // Show values of entry 12
  //      root> t.Show(16);     // Read and show values of entry 16
  //      root> t.Loop();       // Loop on all entries
  //
  
  //     This is the loop skeleton where:
  //    jentry is the global entry number in the chain
  //    ientry is the entry number in the current Tree
  //  Note that the argument to GetEntry must be:
  //    jentry for TChain::GetEntry
  //    ientry for TTree::GetEntry and TBranch::GetEntry
  //
  //       To read only selected branches, Insert statements like:
  // METHOD1:
  //    fChain->SetBranchStatus("*",0);  // disable all branches
  //    fChain->SetBranchStatus("branchname",1);  // activate branchname
  // METHOD2: replace line
  //    fChain->GetEntry(jentry);       //read all branches
  //by  b_branchname->GetEntry(ientry); //read only this branch
  TLatex *latex = new TLatex(); 
  latex->SetNDC();
  latex->SetTextFont(42);
  latex->SetTextColor(kBlack);

  if (fChain == 0) return;
  
  Long64_t nentries = fChain->GetEntriesFast();
  
  // QIE11 digi
  std::map<int, std::map<int, std::map<int, std::map<int, TH1F*>>>> HB_TDC_byScan; // TS, TDC, ieta, depth
  std::map<int, std::map<int, std::map<int, std::map<int, TH1F*>>>> HB_TDC_byScan_effs; // TS, TDC, ieta, depth
  std::map<int, std::map<int, TH1F*>> HB_cell_valid;

  std::map<int, std::map<int, std::map<int,TH1D*>>> HB_landau_fit; // scan point, ieta, depth

  // TP digi
  std::map<int, TH1F*> FB1_by_TS; // ieta
  std::map<int, TH1F*> FB2_by_TS;
  std::map<int, TH1F*> FB3_by_TS;
  // for the TEfficiency to have percent of towers with FG bits set
  std::map<int, TH1F*> Tower_valid;
  // for the stacked histogram
  std::map<int, TH1F*> h1_fg1;
  std::map<int, TH1F*> h1_fg2;
  std::map<int, TH1F*> h1_fg3;

  const int ADCenergy = 36; // about 3 GeV 
  const int FCenergy = 4800; // about 3 GeV 

  int ADC_4GeV[16][4] = {{55, 73, 81, 84},
			 {57, 76, 81, 83},
			 {55, 79, 83, 86},
			 {54, 81, 81, 86},
			 {54, 82, 85, 87},
			 {57, 80, 90, 90},
			 {58, 86, 85, 90},
			 {64, 86, 87, 91},
			 {64, 84, 91, 96},
			 {69, 90, 95, 97},
			 {72, 92, 93, 96},
			 {68, 94, 96, 103},
			 {72, 93, 102, 107},
			 {70, 100, 103, 110},
			 {84, 101, 105, 114},
			 {71, 103, 114, -999}}; // ieta, depth

  int ADC_xml_decoded[32][72][4] = { // ieta (0-15 (ieta - 1), 16-31 (ieta * -1 + 16 to shift). ieta 9-11, iphi 51, depth 1 and 3 is set to 999 since the LUT is 0-ed here. This is Run3Sept2022 LUT
    {{41, 55, 60, 69}, {42, 60, 63, 69}, {39, 60, 70, 69}, {37, 60, 63, 63}, {37, 58, 62, 68}, {41, 62, 63, 67}, {41, 60, 63, 68}, {40, 61, 67, 68}, {39, 55, 57, 63}, {39, 58, 68, 66}, {42, 60, 63, 63}, {41, 55, 61, 67}, {42, 59, 58, 69}, {42, 59, 62, 62}, {44, 61, 69, 70}, {43, 59, 62, 67}, {40, 59, 68, 69}, {44, 60, 67, 68}, {41, 61, 68, 61}, {41, 61, 63, 67}, {38, 60, 63, 67}, {43, 57, 68, 68}, {43, 61, 62, 71}, {43, 62, 62, 70}, {46, 59, 61, 67}, {40, 58, 61, 62}, {41, 62, 66, 63}, {42, 59, 63, 68}, {41, 60, 66, 68}, {44, 63, 71, 71}, {41, 60, 69, 70}, {41, 60, 62, 71}, {41, 59, 66, 62}, {40, 60, 66, 68}, {44, 59, 63, 68}, {39, 59, 61, 61}, {41, 61, 69, 70}, {39, 60, 69, 63}, {40, 60, 68, 68}, {36, 55, 62, 62}, {42, 58, 68, 70}, {40, 61, 61, 69}, {38, 58, 67, 68}, {41, 61, 71, 70}, {39, 59, 61, 61}, {40, 61, 67, 69}, {41, 46, 58, 61}, {37, 56, 63, 70}, {36, 57, 60, 59}, {37, 53, 61, 63}, {44, 62, 63, 69}, {44, 61, 68, 74}, {36, 60, 63, 62}, {42, 60, 68, 71}, {39, 63, 63, 62}, {35, 61, 63, 67}, {40, 58, 62, 62}, {39, 58, 60, 68}, {41, 62, 62, 61}, {40, 62, 62, 67}, {38, 60, 59, 67}, {29, 59, 61, 72}, {38, 60, 68, 67}, {40, 60, 61, 63}, {41, 59, 68, 69}, {40, 61, 66, 70}, {36, 59, 68, 68}, {45, 62, 62, 69}, {42, 59, 63, 71}, {43, 63, 69, 70}, {40, 59, 62, 67}, {40, 59, 62, 63}},
    {{44, 60, 69, 69}, {43, 66, 62, 73}, {44, 62, 79, 73}, {39, 62, 66, 70}, {39, 62, 69, 76}, {41, 63, 69, 72}, {42, 67, 71, 73}, {40, 62, 63, 69}, {33, 61, 68, 68}, {40, 62, 68, 69}, {45, 63, 71, 69}, {42, 60, 63, 71}, {46, 61, 63, 71}, {42, 60, 70, 68}, {48, 71, 70, 72}, {40, 62, 70, 70}, {42, 61, 68, 72}, {49, 68, 69, 71}, {42, 63, 75, 70}, {40, 68, 71, 69}, {45, 61, 68, 67}, {45, 62, 63, 67}, {45, 62, 70, 72}, {42, 62, 69, 72}, {44, 61, 67, 71}, {40, 62, 66, 69}, {44, 69, 73, 71}, {38, 63, 69, 67}, {43, 62, 67, 73}, {44, 69, 69, 71}, {48, 67, 73, 75}, {45, 68, 69, 75}, {41, 60, 69, 66}, {43, 62, 63, 69}, {24, 58, 69, 72}, {40, 61, 68, 68}, {40, 69, 70, 71}, {39, 61, 71, 71}, {43, 63, 73, 72}, {38, 60, 66, 66}, {43, 62, 70, 72}, {38, 62, 66, 73}, {44, 63, 70, 70}, {38, 61, 70, 71}, {36, 68, 71, 68}, {41, 62, 68, 69}, {37, 53, 67, 71}, {37, 58, 63, 70}, {37, 61, 63, 62}, {38, 59, 61, 63}, {33, 63, 73, 75}, {43, 60, 70, 76}, {27, 70, 63, 67}, {45, 62, 71, 70}, {44, 69, 68, 70}, {38, 63, 72, 68}, {40, 62, 68, 70}, {39, 58, 61, 72}, {40, 73, 73, 63}, {43, 61, 67, 63}, {37, 67, 68, 74}, {37, 62, 67, 73}, {41, 62, 72, 73}, {63, 62, 62, 71}, {42, 69, 73, 72}, {39, 66, 73, 71}, {43, 63, 70, 73}, {48, 62, 68, 68}, {42, 62, 70, 76}, {42, 63, 71, 72}, {44, 63, 70, 70}, {39, 62, 66, 69}},
    {{44, 60, 69, 70}, {44, 62, 63, 71}, {79, 68, 75, 70}, {38, 63, 69, 69}, {39, 62, 72, 74}, {41, 63, 73, 69}, {41, 70, 68, 70}, {40, 68, 69, 69}, {40, 60, 67, 69}, {38, 63, 71, 67}, {44, 62, 71, 70}, {44, 58, 66, 71}, {43, 63, 67, 70}, {43, 60, 66, 68}, {44, 73, 72, 75}, {44, 67, 70, 69}, {43, 62, 72, 71}, {50, 69, 73, 69}, {41, 70, 71, 70}, {41, 63, 73, 69}, {44, 68, 71, 69}, {44, 62, 62, 69}, {43, 62, 70, 76}, {42, 61, 70, 69}, {45, 63, 66, 72}, {40, 62, 63, 67}, {43, 70, 74, 70}, {39, 62, 71, 69}, {45, 63, 70, 70}, {42, 60, 71, 70}, {45, 69, 75, 73}, {45, 68, 67, 73}, {42, 61, 71, 70}, {40, 58, 70, 70}, {45, 68, 69, 74}, {41, 62, 69, 62}, {71, 68, 73, 72}, {38, 63, 69, 68}, {42, 63, 73, 70}, {40, 59, 68, 66}, {46, 62, 70, 73}, {38, 62, 68, 68}, {43, 63, 71, 71}, {43, 68, 71, 67}, {42, 69, 70, 73}, {43, 66, 73, 70}, {43, 55, 59, 74}, {39, 57, 68, 69}, {37, 62, 68, 70}, {68, 62, 69, 68}, {46, 68, 72, 74}, {40, 60, 69, 70}, {42, 68, 69, 71}, {44, 62, 73, 68}, {42, 67, 63, 71}, {40, 67, 72, 73}, {39, 62, 67, 67}, {44, 63, 72, 71}, {44, 67, 68, 70}, {43, 62, 67, 62}, {37, 70, 69, 71}, {41, 67, 69, 69}, {40, 69, 74, 70}, {42, 62, 68, 70}, {41, 68, 73, 74}, {40, 66, 71, 71}, {43, 62, 73, 73}, {49, 63, 63, 63}, {42, 63, 70, 76}, {40, 69, 67, 70}, {45, 67, 71, 73}, {41, 62, 63, 67}},
    {{41, 59, 68, 72}, {40, 62, 66, 72}, {37, 68, 73, 75}, {41, 67, 72, 71}, {39, 60, 70, 74}, {45, 67, 74, 71}, {39, 67, 69, 70}, {41, 70, 67, 66}, {38, 57, 68, 71}, {40, 68, 72, 69}, {45, 63, 72, 70}, {47, 60, 62, 72}, {42, 62, 67, 71}, {42, 60, 69, 69}, {44, 69, 71, 73}, {43, 61, 71, 66}, {46, 63, 71, 73}, {52, 68, 72, 73}, {40, 68, 70, 71}, {40, 70, 71, 70}, {44, 69, 72, 74}, {46, 60, 66, 62}, {42, 62, 69, 76}, {44, 62, 70, 70}, {44, 62, 67, 71}, {41, 63, 67, 70}, {42, 69, 74, 70}, {41, 59, 68, 69}, {44, 62, 70, 72}, {43, 69, 69, 71}, {45, 66, 74, 74}, {46, 66, 68, 73}, {42, 63, 68, 71}, {41, 62, 69, 72}, {41, 68, 70, 72}, {41, 63, 68, 63}, {42, 68, 75, 73}, {38, 63, 67, 70}, {43, 63, 74, 70}, {40, 60, 68, 70}, {42, 63, 70, 73}, {37, 63, 63, 71}, {43, 62, 70, 69}, {42, 63, 70, 69}, {41, 68, 70, 71}, {42, 71, 71, 70}, {41, 60, 61, 71}, {38, 58, 67, 68}, {39, 61, 67, 73}, {42, 62, 70, 68}, {36, 69, 68, 77}, {41, 60, 71, 71}, {42, 69, 69, 68}, {43, 62, 74, 70}, {41, 69, 68, 72}, {37, 69, 75, 71}, {72, 61, 61, 69}, {43, 63, 71, 73}, {44, 70, 69, 63}, {44, 63, 62, 68}, {38, 68, 72, 73}, {43, 62, 69, 73}, {40, 69, 72, 73}, {44, 63, 72, 68}, {42, 69, 74, 76}, {38, 68, 72, 70}, {42, 66, 70, 75}, {50, 66, 68, 69}, {42, 62, 69, 75}, {40, 68, 71, 72}, {44, 67, 68, 74}, {41, 62, 69, 69}},
    {{38, 59, 68, 72}, {40, 63, 69, 73}, {45, 69, 71, 76}, {36, 69, 72, 73}, {40, 62, 70, 76}, {41, 70, 72, 74}, {41, 63, 72, 72}, {39, 68, 69, 74}, {42, 62, 72, 73}, {41, 63, 71, 73}, {44, 71, 72, 73}, {43, 59, 69, 70}, {42, 63, 72, 77}, {44, 67, 72, 71}, {44, 72, 75, 75}, {46, 63, 74, 72}, {44, 62, 70, 74}, {49, 63, 74, 77}, {41, 70, 70, 71}, {41, 63, 71, 73}, {41, 69, 74, 73}, {44, 63, 71, 74}, {46, 68, 70, 75}, {42, 63, 68, 69}, {43, 62, 69, 71}, {42, 63, 71, 69}, {42, 68, 73, 76}, {40, 58, 70, 72}, {42, 63, 72, 71}, {42, 69, 73, 70}, {44, 71, 71, 75}, {42, 67, 70, 70}, {42, 63, 67, 72}, {43, 60, 70, 73}, {45, 69, 73, 78}, {41, 67, 68, 70}, {42, 69, 74, 74}, {37, 68, 73, 72}, {43, 63, 71, 73}, {41, 61, 72, 72}, {38, 69, 70, 71}, {38, 67, 63, 76}, {47, 69, 78, 73}, {43, 67, 72, 69}, {38, 63, 70, 74}, {42, 74, 74, 69}, {41, 57, 60, 76}, {40, 61, 68, 69}, {40, 60, 66, 72}, {44, 67, 67, 71}, {43, 68, 72, 74}, {40, 69, 72, 72}, {41, 69, 70, 76}, {42, 68, 71, 74}, {41, 68, 70, 68}, {40, 69, 72, 68}, {42, 62, 74, 78}, {41, 67, 71, 71}, {39, 63, 68, 72}, {39, 67, 68, 67}, {42, 68, 69, 75}, {38, 63, 72, 77}, {45, 63, 72, 69}, {41, 68, 73, 73}, {44, 68, 69, 72}, {39, 73, 76, 72}, {41, 62, 69, 74}, {43, 66, 72, 72}, {41, 69, 70, 72}, {43, 68, 72, 71}, {42, 66, 69, 74}, {40, 67, 68, 72}},
    {{45, 67, 72, 77}, {44, 69, 72, 81}, {47, 71, 77, 81}, {42, 67, 75, 81}, {46, 72, 73, 77}, {44, 72, 71, 77}, {43, 72, 77, 79}, {44, 69, 73, 75}, {44, 69, 72, 83}, {42, 72, 76, 76}, {48, 71, 75, 79}, {47, 61, 71, 78}, {48, 73, 78, 81}, {48, 70, 76, 77}, {50, 74, 80, 81}, {47, 73, 71, 79}, {50, 71, 75, 80}, {53, 71, 79, 81}, {47, 73, 77, 78}, {43, 70, 76, 79}, {47, 72, 75, 79}, {45, 69, 72, 80}, {51, 72, 77, 79}, {48, 67, 72, 77}, {47, 69, 75, 76}, {43, 67, 71, 75}, {49, 74, 79, 80}, {43, 60, 72, 73}, {46, 74, 76, 80}, {48, 72, 78, 77}, {49, 74, 75, 79}, {46, 71, 74, 80}, {45, 72, 74, 76}, {45, 66, 74, 82}, {49, 74, 79, 80}, {43, 66, 73, 76}, {46, 76, 78, 80}, {42, 69, 76, 75}, {47, 70, 76, 82}, {44, 69, 78, 76}, {41, 70, 78, 78}, {41, 70, 69, 80}, {48, 75, 81, 80}, {48, 69, 73, 77}, {42, 73, 78, 80}, {45, 74, 78, 77}, {49, 69, 68, 77}, {42, 68, 68, 75}, {41, 67, 72, 74}, {47, 62, 75, 73}, {48, 75, 72, 81}, {42, 72, 77, 80}, {48, 75, 73, 81}, {43, 74, 74, 80}, {47, 71, 73, 73}, {34, 73, 78, 75}, {49, 70, 78, 80}, {46, 67, 73, 77}, {47, 75, 77, 77}, {40, 68, 71, 80}, {47, 70, 74, 74}, {43, 68, 72, 80}, {46, 74, 73, 77}, {44, 70, 75, 80}, {50, 71, 74, 80}, {43, 70, 77, 79}, {45, 72, 79, 81}, {48, 70, 75, 74}, {50, 74, 76, 78}, {44, 71, 74, 77}, {47, 75, 75, 79}, {44, 70, 72, 78}},
    {{48, 68, 75, 81}, {47, 71, 74, 80}, {49, 74, 74, 81}, {44, 68, 76, 81}, {47, 68, 76, 81}, {49, 70, 76, 78}, {47, 77, 77, 82}, {47, 74, 72, 78}, {50, 70, 78, 83}, {47, 72, 79, 79}, {46, 71, 78, 80}, {47, 62, 74, 79}, {52, 72, 77, 83}, {50, 69, 72, 80}, {49, 77, 80, 82}, {53, 74, 78, 80}, {51, 71, 77, 83}, {58, 70, 77, 80}, {47, 75, 82, 79}, {48, 71, 78, 80}, {62, 75, 74, 80}, {50, 69, 73, 79}, {54, 76, 79, 84}, {52, 69, 72, 77}, {47, 72, 80, 80}, {45, 68, 71, 74}, {48, 75, 80, 79}, {46, 60, 75, 79}, {48, 71, 78, 81}, {48, 72, 80, 79}, {52, 75, 80, 83}, {49, 63, 74, 77}, {48, 74, 77, 79}, {47, 70, 77, 81}, {48, 74, 75, 79}, {43, 67, 76, 78}, {49, 74, 81, 82}, {45, 68, 80, 78}, {45, 75, 79, 82}, {48, 70, 77, 79}, {45, 71, 79, 78}, {46, 70, 68, 81}, {51, 76, 81, 82}, {52, 72, 75, 80}, {43, 73, 78, 80}, {48, 72, 79, 81}, {45, 71, 70, 78}, {45, 63, 70, 80}, {43, 70, 76, 73}, {49, 70, 78, 73}, {48, 72, 76, 87}, {43, 70, 79, 82}, {48, 76, 76, 81}, {46, 72, 75, 74}, {47, 73, 75, 81}, {42, 72, 79, 74}, {52, 70, 81, 85}, {52, 68, 74, 80}, {45, 77, 76, 76}, {44, 69, 70, 79}, {84, 73, 77, 77}, {43, 73, 73, 80}, {48, 68, 80, 82}, {51, 72, 77, 80}, {50, 72, 75, 84}, {44, 72, 78, 77}, {44, 73, 77, 82}, {49, 71, 75, 75}, {51, 73, 76, 82}, {45, 73, 77, 80}, {49, 75, 80, 81}, {46, 74, 77, 77}},
    {{44, 63, 71, 79}, {49, 71, 71, 81}, {44, 72, 75, 79}, {45, 68, 75, 79}, {44, 68, 74, 78}, {44, 70, 76, 78}, {34, 73, 74, 80}, {46, 74, 71, 77}, {49, 63, 73, 82}, {46, 68, 73, 77}, {43, 72, 75, 74}, {47, 62, 67, 77}, {50, 68, 77, 79}, {49, 69, 74, 76}, {47, 74, 80, 81}, {49, 71, 73, 80}, {45, 69, 74, 79}, {57, 72, 73, 78}, {46, 73, 76, 80}, {47, 69, 76, 76}, {48, 73, 71, 79}, {52, 69, 73, 78}, {49, 72, 78, 80}, {47, 63, 72, 73}, {46, 63, 75, 76}, {46, 70, 68, 72}, {46, 70, 74, 80}, {48, 61, 72, 78}, {44, 69, 74, 79}, {47, 73, 78, 74}, {51, 75, 74, 81}, {47, 61, 72, 76}, {46, 71, 74, 74}, {47, 70, 75, 78}, {46, 69, 74, 80}, {45, 66, 71, 76}, {44, 74, 75, 80}, {44, 70, 76, 77}, {46, 70, 79, 81}, {45, 72, 77, 76}, {42, 69, 74, 76}, {41, 68, 68, 81}, {46, 73, 79, 78}, {49, 72, 75, 74}, {52, 67, 73, 80}, {46, 70, 76, 77}, {49, 68, 67, 78}, {44, 63, 72, 75}, {41, 71, 71, 74}, {44, 68, 75, 77}, {48, 71, 73, 82}, {44, 68, 74, 78}, {42, 72, 80, 79}, {45, 74, 71, 71}, {45, 67, 78, 81}, {43, 69, 77, 75}, {50, 70, 72, 81}, {51, 63, 72, 77}, {40, 72, 69, 77}, {42, 74, 75, 74}, {44, 63, 71, 77}, {46, 69, 76, 72}, {41, 70, 70, 80}, {48, 73, 76, 75}, {47, 70, 73, 81}, {45, 70, 78, 77}, {41, 71, 77, 80}, {50, 72, 75, 75}, {45, 67, 72, 81}, {47, 69, 71, 80}, {46, 71, 77, 75}, {47, 71, 73, 75}},
    {{50, 73, 81, 85}, {48, 80, 81, 81}, {50, 71, 80, 83}, {48, 72, 81, 85}, {52, 76, 83, 84}, {49, 78, 82, 82}, {40, 75, 82, 83}, {48, 70, 77, 81}, {50, 72, 80, 83}, {51, 73, 77, 83}, {48, 77, 82, 83}, {52, 70, 76, 83}, {56, 69, 80, 83}, {49, 73, 78, 81}, {54, 80, 83, 84}, {51, 78, 81, 82}, {51, 70, 81, 84}, {59, 78, 82, 85}, {51, 74, 78, 82}, {49, 72, 79, 79}, {54, 80, 81, 84}, {56, 75, 79, 84}, {52, 75, 81, 82}, {54, 73, 81, 80}, {53, 70, 81, 86}, {53, 79, 80, 81}, {52, 74, 80, 88}, {52, 63, 75, 82}, {49, 75, 80, 84}, {52, 75, 83, 84}, {54, 75, 80, 82}, {53, 69, 81, 83}, {54, 77, 81, 83}, {49, 76, 83, 84}, {52, 71, 80, 84}, {45, 68, 77, 80}, {54, 76, 86, 85}, {45, 76, 81, 81}, {50, 75, 83, 84}, {49, 72, 80, 84}, {53, 77, 82, 82}, {46, 72, 75, 82}, {54, 79, 82, 84}, {47, 75, 81, 82}, {52, 70, 87, 85}, {47, 77, 82, 82}, {57, 69, 73, 84}, {44, 70, 81, 82}, {44, 77, 80, 81}, {49, 74, 81, 83}, {999, 78, 999, 86}, {49, 75, 81, 87}, {46, 76, 80, 77}, {53, 71, 74, 78}, {50, 80, 80, 86}, {52, 74, 80, 83}, {52, 72, 86, 85}, {53, 73, 84, 83}, {52, 71, 77, 83}, {48, 82, 80, 81}, {47, 72, 79, 83}, {51, 77, 84, 84}, {46, 77, 80, 83}, {58, 76, 81, 82}, {49, 74, 82, 85}, {50, 76, 82, 85}, {49, 73, 77, 84}, {59, 79, 80, 80}, {50, 76, 81, 84}, {46, 76, 80, 84}, {52, 76, 83, 85}, {49, 76, 82, 82}},
    {{57, 78, 83, 84}, {49, 81, 81, 82}, {52, 77, 82, 85}, {53, 70, 84, 85}, {57, 81, 83, 85}, {54, 80, 83, 83}, {67, 80, 82, 84}, {55, 77, 80, 84}, {45, 63, 81, 83}, {56, 77, 77, 85}, {52, 80, 84, 83}, {56, 71, 81, 84}, {59, 76, 82, 86}, {54, 76, 81, 83}, {56, 83, 83, 85}, {54, 75, 80, 82}, {51, 77, 85, 85}, {59, 75, 82, 86}, {56, 79, 82, 86}, {52, 76, 82, 83}, {56, 82, 81, 85}, {58, 77, 80, 83}, {56, 82, 84, 87}, {57, 78, 82, 81}, {56, 76, 83, 87}, {52, 79, 81, 83}, {59, 77, 83, 89}, {56, 69, 81, 84}, {55, 76, 82, 86}, {52, 81, 85, 82}, {59, 79, 83, 86}, {58, 72, 81, 82}, {55, 78, 85, 84}, {50, 79, 84, 84}, {57, 80, 83, 86}, {53, 72, 74, 83}, {57, 73, 89, 87}, {45, 75, 82, 80}, {58, 80, 84, 87}, {52, 79, 80, 83}, {52, 79, 85, 83}, {49, 76, 76, 81}, {59, 81, 86, 89}, {57, 77, 82, 85}, {51, 79, 88, 87}, {49, 77, 82, 82}, {58, 74, 82, 88}, {45, 70, 81, 83}, {49, 80, 78, 84}, {52, 77, 79, 85}, {999, 80, 999, 85}, {55, 80, 81, 84}, {53, 81, 84, 83}, {52, 75, 76, 81}, {55, 81, 86, 86}, {57, 81, 85, 86}, {52, 77, 84, 83}, {55, 76, 82, 86}, {58, 78, 82, 81}, {53, 81, 80, 82}, {52, 78, 82, 83}, {51, 78, 82, 85}, {49, 82, 84, 84}, {55, 80, 82, 82}, {57, 82, 84, 86}, {53, 77, 83, 85}, {48, 76, 80, 85}, {61, 80, 82, 82}, {55, 76, 83, 85}, {51, 76, 81, 85}, {57, 80, 82, 86}, {51, 81, 82, 83}},
    {{58, 81, 84, 88}, {52, 82, 81, 83}, {51, 79, 83, 86}, {52, 71, 81, 84}, {55, 81, 85, 92}, {52, 81, 83, 83}, {57, 83, 85, 87}, {52, 77, 75, 83}, {51, 73, 83, 86}, {52, 75, 80, 85}, {56, 81, 87, 85}, {55, 78, 81, 85}, {59, 81, 81, 87}, {56, 78, 81, 84}, {53, 84, 84, 86}, {57, 77, 82, 84}, {48, 81, 82, 86}, {61, 77, 82, 85}, {57, 83, 81, 86}, {52, 80, 81, 84}, {58, 82, 85, 86}, {59, 79, 79, 86}, {58, 83, 84, 87}, {59, 81, 82, 82}, {58, 79, 84, 89}, {55, 81, 82, 86}, {58, 79, 81, 89}, {56, 70, 80, 87}, {57, 80, 85, 89}, {52, 83, 85, 86}, {57, 80, 85, 85}, {54, 74, 82, 81}, {58, 79, 85, 89}, {50, 81, 84, 84}, {57, 82, 84, 87}, {54, 76, 81, 83}, {59, 82, 86, 89}, {50, 80, 82, 80}, {54, 81, 84, 88}, {54, 77, 83, 84}, {50, 83, 84, 87}, {50, 80, 81, 83}, {59, 81, 85, 88}, {53, 79, 83, 85}, {55, 79, 84, 86}, {53, 81, 81, 83}, {60, 76, 81, 89}, {54, 72, 81, 84}, {55, 80, 82, 84}, {54, 77, 78, 82}, {999, 84, 999, 88}, {58, 80, 81, 84}, {51, 82, 85, 87}, {51, 72, 81, 82}, {53, 86, 87, 86}, {57, 81, 84, 86}, {55, 83, 86, 87}, {57, 77, 80, 87}, {57, 83, 86, 84}, {48, 79, 82, 81}, {50, 79, 81, 84}, {53, 80, 85, 84}, {50, 84, 81, 86}, {52, 82, 84, 83}, {57, 82, 84, 88}, {58, 78, 85, 84}, {52, 79, 84, 88}, {59, 82, 80, 84}, {59, 80, 86, 84}, {57, 81, 83, 86}, {59, 82, 84, 87}, {55, 80, 83, 83}},
    {{55, 80, 83, 89}, {51, 83, 82, 85}, {49, 79, 83, 85}, {51, 74, 84, 88}, {53, 80, 84, 87}, {52, 83, 84, 84}, {39, 81, 83, 88}, {53, 75, 83, 85}, {44, 73, 83, 85}, {49, 77, 81, 88}, {56, 80, 87, 85}, {57, 80, 81, 84}, {59, 79, 82, 90}, {54, 78, 82, 84}, {54, 84, 85, 87}, {58, 80, 84, 85}, {83, 78, 82, 88}, {61, 77, 82, 86}, {51, 81, 83, 85}, {49, 80, 83, 82}, {56, 81, 84, 88}, {59, 81, 81, 88}, {56, 83, 86, 86}, {58, 77, 83, 84}, {57, 76, 82, 90}, {55, 81, 84, 84}, {52, 80, 80, 91}, {58, 77, 83, 85}, {53, 81, 84, 90}, {49, 83, 86, 83}, {53, 83, 83, 87}, {52, 73, 85, 82}, {58, 81, 84, 86}, {53, 82, 83, 84}, {58, 82, 86, 87}, {54, 77, 80, 83}, {59, 82, 87, 89}, {50, 79, 84, 83}, {52, 82, 84, 89}, {54, 78, 85, 84}, {50, 83, 85, 87}, {50, 80, 80, 85}, {57, 80, 85, 88}, {55, 82, 84, 89}, {50, 81, 85, 88}, {51, 80, 84, 85}, {58, 73, 82, 89}, {52, 73, 80, 84}, {55, 81, 82, 86}, {55, 78, 81, 85}, {999, 83, 999, 85}, {58, 81, 86, 87}, {51, 81, 83, 85}, {52, 74, 81, 85}, {49, 83, 85, 86}, {86, 82, 88, 87}, {56, 82, 85, 89}, {57, 79, 85, 85}, {55, 82, 83, 84}, {49, 80, 85, 83}, {51, 81, 77, 82}, {52, 79, 85, 85}, {49, 84, 83, 85}, {53, 81, 84, 85}, {53, 81, 85, 87}, {58, 78, 84, 86}, {51, 80, 83, 89}, {60, 83, 85, 85}, {56, 80, 85, 86}, {57, 76, 83, 86}, {56, 81, 82, 88}, {55, 81, 85, 84}},
    {{58, 84, 88, 93}, {52, 82, 86, 90}, {58, 85, 86, 95}, {52, 74, 86, 94}, {58, 82, 86, 94}, {53, 83, 90, 92}, {52, 84, 86, 92}, {57, 83, 84, 92}, {56, 73, 84, 95}, {52, 83, 87, 93}, {55, 85, 87, 91}, {58, 82, 85, 89}, {59, 77, 84, 95}, {61, 83, 84, 93}, {58, 85, 86, 94}, {57, 82, 87, 93}, {57, 81, 86, 93}, {71, 82, 85, 93}, {57, 84, 87, 91}, {55, 85, 90, 92}, {56, 83, 86, 98}, {61, 86, 85, 97}, {59, 84, 88, 90}, {60, 82, 84, 91}, {57, 82, 88, 93}, {57, 82, 86, 91}, {47, 84, 83, 93}, {56, 87, 88, 93}, {58, 81, 88, 92}, {54, 85, 89, 94}, {57, 85, 90, 94}, {59, 85, 88, 96}, {51, 77, 85, 90}, {71, 82, 88, 93}, {61, 83, 85, 95}, {58, 86, 88, 92}, {58, 80, 86, 94}, {54, 82, 84, 89}, {57, 84, 88, 95}, {55, 85, 89, 88}, {56, 81, 88, 96}, {56, 84, 86, 94}, {62, 82, 87, 93}, {58, 84, 89, 94}, {53, 85, 87, 96}, {59, 82, 85, 94}, {59, 76, 80, 95}, {57, 72, 81, 90}, {56, 82, 86, 90}, {57, 80, 84, 89}, {58, 83, 84, 93}, {57, 84, 86, 97}, {58, 87, 88, 89}, {60, 81, 82, 97}, {55, 82, 89, 89}, {53, 84, 90, 94}, {57, 81, 87, 92}, {58, 80, 86, 95}, {59, 89, 88, 91}, {54, 84, 87, 94}, {54, 83, 85, 89}, {54, 79, 83, 91}, {56, 87, 88, 90}, {56, 82, 82, 92}, {58, 84, 87, 94}, {60, 82, 89, 95}, {57, 82, 86, 94}, {62, 82, 86, 94}, {59, 83, 86, 93}, {61, 83, 87, 100}, {58, 84, 86, 90}, {56, 85, 86, 91}},
    {{69, 88, 92, 98}, {57, 86, 88, 94}, {61, 90, 89, 100}, {53, 80, 89, 97}, {59, 87, 90, 96}, {54, 86, 91, 98}, {56, 88, 91, 97}, {55, 84, 88, 96}, {61, 80, 89, 98}, {53, 85, 90, 97}, {57, 88, 91, 96}, {61, 85, 86, 96}, {60, 82, 88, 98}, {60, 87, 90, 96}, {60, 89, 92, 100}, {58, 85, 89, 94}, {58, 86, 92, 100}, {68, 82, 90, 99}, {59, 90, 91, 97}, {44, 87, 91, 98}, {60, 89, 90, 100}, {55, 89, 90, 100}, {60, 87, 93, 98}, {62, 87, 89, 97}, {60, 90, 90, 98}, {59, 84, 85, 99}, {47, 87, 91, 97}, {57, 91, 92, 92}, {60, 85, 92, 101}, {55, 87, 92, 96}, {59, 89, 93, 100}, {59, 87, 91, 100}, {61, 85, 90, 94}, {55, 86, 91, 101}, {67, 86, 91, 96}, {56, 84, 88, 97}, {61, 85, 91, 96}, {46, 87, 86, 92}, {59, 87, 96, 101}, {55, 85, 90, 95}, {58, 88, 92, 98}, {58, 88, 87, 100}, {68, 88, 92, 100}, {40, 89, 94, 97}, {41, 88, 89, 100}, {61, 91, 90, 101}, {62, 77, 88, 96}, {58, 81, 85, 96}, {57, 84, 89, 94}, {57, 82, 85, 94}, {60, 88, 87, 98}, {61, 90, 91, 95}, {56, 90, 88, 100}, {62, 85, 86, 98}, {56, 91, 91, 96}, {53, 85, 90, 97}, {58, 86, 93, 94}, {59, 83, 88, 100}, {59, 93, 92, 94}, {55, 86, 90, 98}, {57, 88, 88, 96}, {53, 85, 87, 96}, {58, 89, 92, 92}, {58, 85, 89, 96}, {59, 88, 89, 98}, {61, 85, 93, 101}, {59, 84, 93, 100}, {54, 87, 88, 100}, {61, 88, 91, 96}, {61, 86, 89, 101}, {39, 88, 90, 95}, {57, 87, 89, 95}},
    {{83, 92, 98, 99}, {59, 91, 90, 96}, {62, 93, 97, 101}, {57, 89, 92, 101}, {59, 89, 94, 95}, {58, 89, 94, 97}, {58, 93, 95, 101}, {59, 91, 89, 96}, {60, 85, 94, 102}, {52, 89, 95, 101}, {61, 92, 97, 96}, {59, 91, 89, 98}, {60, 87, 93, 100}, {62, 90, 93, 101}, {62, 97, 97, 101}, {57, 89, 94, 96}, {60, 90, 94, 101}, {72, 85, 93, 100}, {61, 96, 97, 97}, {58, 88, 95, 102}, {60, 91, 98, 98}, {60, 89, 93, 101}, {63, 92, 98, 100}, {61, 87, 90, 94}, {54, 94, 94, 98}, {59, 86, 91, 95}, {49, 92, 94, 102}, {59, 91, 98, 97}, {59, 90, 94, 101}, {46, 89, 100, 96}, {58, 95, 100, 102}, {62, 92, 93, 99}, {61, 85, 95, 98}, {57, 88, 98, 97}, {68, 93, 96, 101}, {61, 90, 92, 93}, {60, 89, 93, 100}, {48, 88, 89, 94}, {59, 93, 102, 103}, {59, 88, 99, 100}, {56, 90, 97, 97}, {49, 89, 88, 99}, {68, 92, 97, 103}, {62, 92, 96, 99}, {46, 91, 98, 103}, {63, 91, 94, 101}, {63, 86, 92, 98}, {53, 79, 83, 99}, {60, 88, 92, 95}, {57, 84, 91, 99}, {67, 91, 91, 97}, {62, 91, 93, 100}, {57, 94, 95, 100}, {66, 92, 93, 100}, {58, 93, 98, 100}, {43, 86, 97, 97}, {60, 89, 95, 99}, {67, 90, 90, 99}, {47, 94, 100, 98}, {57, 88, 97, 101}, {57, 87, 88, 93}, {57, 88, 91, 91}, {58, 94, 96, 97}, {57, 86, 95, 99}, {58, 94, 95, 99}, {68, 88, 96, 102}, {58, 93, 96, 101}, {42, 91, 91, 101}, {62, 92, 97, 98}, {68, 91, 95, 102}, {61, 92, 94, 99}, {60, 89, 95, 96}},
    {{52, 85, 95, 0}, {70, 85, 90, 0}, {78, 86, 93, 0}, {74, 85, 91, 0}, {73, 82, 96, 0}, {77, 84, 91, 0}, {79, 85, 93, 0}, {78, 86, 90, 0}, {81, 82, 90, 0}, {78, 87, 89, 0}, {57, 86, 97, 0}, {78, 86, 88, 0}, {76, 82, 90, 0}, {56, 87, 88, 0}, {75, 88, 96, 0}, {74, 84, 92, 0}, {76, 84, 92, 0}, {76, 84, 89, 0}, {80, 85, 93, 0}, {57, 85, 96, 0}, {77, 83, 92, 0}, {58, 84, 91, 0}, {62, 86, 93, 0}, {76, 85, 91, 0}, {76, 87, 94, 0}, {81, 84, 90, 0}, {70, 84, 89, 0}, {52, 87, 96, 0}, {76, 85, 91, 0}, {79, 87, 99, 0}, {74, 86, 93, 0}, {61, 89, 94, 0}, {63, 80, 92, 0}, {81, 82, 94, 0}, {71, 88, 90, 0}, {80, 86, 96, 0}, {71, 85, 92, 0}, {60, 84, 91, 0}, {76, 86, 93, 0}, {49, 83, 93, 0}, {80, 86, 95, 0}, {82, 85, 89, 0}, {79, 86, 88, 0}, {79, 87, 94, 0}, {61, 84, 93, 0}, {73, 89, 95, 0}, {73, 78, 88, 0}, {75, 75, 87, 0}, {55, 82, 90, 0}, {54, 78, 93, 0}, {79, 85, 86, 0}, {79, 84, 93, 0}, {71, 90, 96, 0}, {75, 86, 85, 0}, {79, 86, 95, 0}, {75, 90, 98, 0}, {78, 83, 91, 0}, {71, 86, 91, 0}, {70, 88, 92, 0}, {76, 83, 94, 0}, {78, 84, 90, 0}, {73, 84, 89, 0}, {69, 88, 89, 0}, {80, 84, 92, 0}, {71, 86, 94, 0}, {63, 84, 96, 0}, {81, 86, 93, 0}, {81, 84, 95, 0}, {80, 85, 94, 0}, {83, 84, 91, 0}, {58, 87, 91, 0}, {70, 85, 91, 0}},
    {{39, 55, 62, 60}, {43, 56, 60, 63}, {43, 60, 62, 70}, {41, 56, 58, 63}, {40, 57, 69, 67}, {83, 52, 60, 66}, {40, 58, 62, 62}, {45, 58, 58, 63}, {32, 56, 58, 62}, {42, 53, 61, 61}, {46, 59, 62, 68}, {43, 57, 60, 60}, {44, 60, 63, 69}, {45, 56, 61, 62}, {43, 62, 61, 63}, {38, 56, 63, 61}, {48, 56, 61, 67}, {42, 57, 61, 63}, {38, 58, 59, 63}, {46, 61, 61, 67}, {43, 53, 62, 69}, {46, 57, 60, 61}, {40, 60, 59, 68}, {43, 59, 61, 62}, {42, 57, 62, 63}, {43, 58, 60, 59}, {41, 60, 62, 70}, {43, 56, 59, 67}, {40, 58, 62, 63}, {43, 48, 61, 62}, {37, 60, 60, 69}, {77, 52, 61, 69}, {41, 57, 62, 66}, {46, 54, 56, 62}, {42, 59, 62, 62}, {53, 56, 60, 58}, {40, 57, 60, 72}, {39, 59, 63, 62}, {50, 61, 61, 69}, {39, 55, 60, 61}, {40, 58, 60, 63}, {41, 59, 60, 67}, {47, 58, 62, 67}, {39, 60, 68, 68}, {45, 60, 57, 59}, {40, 60, 62, 71}, {43, 58, 60, 61}, {42, 56, 62, 67}, {41, 54, 59, 63}, {43, 57, 59, 68}, {42, 57, 60, 67}, {39, 60, 60, 67}, {39, 51, 55, 61}, {39, 53, 62, 61}, {41, 62, 61, 70}, {38, 58, 67, 68}, {41, 55, 61, 59}, {39, 49, 62, 61}, {43, 63, 63, 69}, {43, 58, 60, 68}, {41, 62, 63, 67}, {42, 57, 59, 61}, {39, 55, 68, 66}, {41, 57, 61, 63}, {37, 56, 62, 62}, {25, 60, 61, 71}, {45, 58, 62, 63}, {43, 61, 61, 67}, {42, 58, 62, 63}, {43, 58, 62, 68}, {41, 60, 67, 68}, {42, 57, 63, 62}},
    {{40, 59, 62, 63}, {47, 60, 67, 69}, {31, 62, 67, 72}, {44, 59, 60, 72}, {42, 61, 72, 72}, {89, 59, 68, 70}, {39, 60, 67, 69}, {45, 60, 61, 69}, {40, 59, 59, 71}, {41, 60, 67, 68}, {45, 61, 62, 69}, {44, 61, 71, 67}, {40, 61, 63, 72}, {48, 62, 69, 72}, {44, 62, 68, 67}, {26, 61, 70, 63}, {49, 60, 61, 71}, {43, 61, 66, 71}, {45, 62, 63, 68}, {39, 62, 63, 72}, {46, 60, 68, 73}, {50, 60, 63, 72}, {42, 60, 63, 67}, {44, 68, 70, 70}, {44, 60, 61, 68}, {42, 67, 71, 68}, {44, 62, 63, 74}, {29, 58, 63, 70}, {39, 61, 67, 71}, {31, 59, 69, 72}, {39, 62, 61, 71}, {85, 67, 69, 73}, {40, 60, 61, 74}, {49, 60, 62, 69}, {45, 60, 68, 69}, {56, 57, 66, 61}, {44, 59, 62, 77}, {41, 61, 71, 70}, {50, 63, 68, 73}, {41, 59, 63, 69}, {41, 62, 60, 71}, {45, 63, 61, 72}, {46, 60, 72, 71}, {16, 67, 70, 73}, {48, 62, 63, 62}, {32, 61, 70, 68}, {28, 59, 61, 76}, {42, 67, 63, 68}, {43, 57, 60, 71}, {44, 60, 68, 70}, {26, 59, 67, 70}, {27, 61, 69, 70}, {36, 58, 58, 63}, {36, 61, 63, 70}, {46, 63, 69, 69}, {41, 61, 70, 67}, {40, 59, 62, 70}, {39, 54, 63, 72}, {45, 70, 73, 68}, {48, 62, 68, 71}, {40, 67, 68, 68}, {27, 60, 69, 69}, {41, 58, 67, 70}, {38, 59, 61, 71}, {40, 60, 69, 68}, {44, 67, 70, 73}, {45, 62, 66, 69}, {36, 69, 63, 70}, {43, 60, 68, 69}, {44, 60, 63, 70}, {30, 63, 71, 73}, {46, 61, 69, 71}},
    {{41, 60, 62, 67}, {45, 63, 71, 73}, {46, 62, 67, 73}, {44, 61, 61, 73}, {44, 62, 73, 73}, {86, 63, 63, 73}, {41, 58, 69, 69}, {45, 60, 62, 70}, {45, 57, 60, 72}, {46, 61, 71, 71}, {45, 59, 61, 73}, {44, 61, 69, 69}, {45, 61, 67, 71}, {44, 62, 68, 72}, {46, 61, 68, 72}, {46, 59, 69, 71}, {45, 60, 66, 71}, {42, 61, 68, 71}, {45, 62, 61, 68}, {46, 62, 66, 72}, {44, 62, 68, 74}, {48, 62, 68, 76}, {44, 61, 62, 68}, {45, 63, 69, 70}, {45, 54, 62, 71}, {44, 68, 70, 73}, {46, 60, 67, 69}, {44, 58, 68, 70}, {45, 63, 63, 73}, {43, 63, 67, 74}, {40, 61, 66, 72}, {85, 63, 69, 73}, {41, 60, 63, 71}, {49, 62, 69, 72}, {44, 62, 62, 68}, {55, 60, 67, 67}, {43, 59, 62, 76}, {43, 62, 69, 73}, {52, 63, 68, 73}, {42, 61, 67, 70}, {41, 56, 63, 69}, {46, 63, 67, 70}, {49, 62, 73, 77}, {41, 62, 69, 74}, {47, 63, 62, 63}, {43, 69, 69, 70}, {47, 61, 61, 75}, {44, 63, 69, 70}, {42, 59, 59, 68}, {46, 61, 67, 75}, {40, 60, 70, 68}, {43, 67, 67, 69}, {39, 58, 59, 70}, {38, 60, 68, 70}, {49, 63, 62, 71}, {41, 63, 73, 73}, {39, 59, 62, 68}, {39, 62, 72, 73}, {44, 61, 70, 69}, {48, 60, 66, 71}, {41, 69, 71, 70}, {45, 61, 67, 70}, {41, 61, 68, 72}, {39, 60, 63, 70}, {40, 60, 62, 72}, {41, 69, 72, 75}, {46, 60, 69, 70}, {47, 68, 69, 71}, {43, 61, 68, 70}, {44, 62, 70, 74}, {44, 62, 63, 71}, {47, 63, 69, 71}},
    {{40, 59, 63, 68}, {46, 61, 68, 72}, {47, 63, 69, 74}, {42, 59, 60, 74}, {46, 63, 74, 74}, {85, 60, 66, 75}, {40, 59, 67, 69}, {44, 59, 61, 72}, {45, 61, 61, 72}, {47, 60, 72, 71}, {47, 60, 63, 72}, {46, 60, 69, 70}, {32, 63, 71, 71}, {44, 63, 68, 74}, {47, 68, 61, 72}, {46, 59, 69, 72}, {47, 60, 61, 70}, {42, 62, 69, 72}, {44, 63, 61, 71}, {47, 63, 67, 72}, {45, 62, 69, 73}, {49, 61, 69, 75}, {47, 63, 67, 69}, {47, 62, 69, 71}, {46, 57, 63, 71}, {44, 69, 70, 72}, {49, 60, 68, 72}, {43, 60, 67, 68}, {43, 62, 67, 73}, {46, 60, 67, 76}, {42, 63, 68, 74}, {84, 63, 67, 76}, {43, 61, 69, 73}, {51, 62, 63, 69}, {42, 62, 63, 73}, {53, 57, 63, 67}, {46, 59, 62, 76}, {43, 62, 71, 73}, {54, 63, 66, 74}, {41, 61, 61, 67}, {41, 55, 67, 74}, {44, 62, 70, 70}, {51, 62, 73, 75}, {40, 63, 68, 73}, {50, 67, 69, 69}, {44, 63, 69, 74}, {43, 60, 68, 70}, {44, 61, 63, 66}, {45, 58, 61, 74}, {47, 67, 63, 73}, {44, 60, 71, 71}, {43, 61, 69, 69}, {40, 63, 67, 72}, {39, 58, 68, 74}, {46, 62, 62, 69}, {42, 59, 72, 77}, {42, 63, 61, 62}, {42, 61, 68, 74}, {46, 63, 74, 67}, {48, 60, 63, 74}, {42, 70, 72, 70}, {35, 61, 67, 70}, {42, 63, 69, 73}, {39, 61, 62, 73}, {39, 60, 68, 71}, {44, 68, 73, 74}, {45, 62, 68, 73}, {49, 68, 67, 72}, {41, 60, 68, 69}, {46, 62, 68, 73}, {44, 62, 68, 73}, {46, 62, 71, 71}},
    {{44, 60, 71, 73}, {44, 68, 72, 74}, {47, 63, 72, 74}, {44, 62, 68, 73}, {42, 60, 70, 73}, {86, 60, 67, 74}, {44, 60, 68, 73}, {43, 60, 66, 72}, {40, 59, 63, 73}, {46, 60, 70, 73}, {47, 63, 70, 72}, {48, 62, 69, 72}, {45, 60, 68, 74}, {47, 60, 63, 71}, {44, 69, 67, 70}, {48, 62, 69, 74}, {45, 60, 66, 69}, {47, 67, 71, 76}, {48, 66, 67, 76}, {48, 61, 68, 72}, {44, 60, 70, 79}, {50, 63, 63, 78}, {44, 63, 67, 67}, {50, 67, 72, 70}, {44, 58, 61, 72}, {41, 68, 69, 70}, {46, 62, 68, 76}, {45, 61, 71, 75}, {48, 62, 63, 75}, {45, 61, 67, 75}, {39, 67, 68, 74}, {80, 61, 63, 72}, {44, 67, 71, 77}, {52, 61, 63, 73}, {45, 63, 68, 73}, {55, 53, 62, 69}, {45, 58, 61, 74}, {43, 69, 68, 72}, {54, 62, 70, 77}, {45, 62, 62, 71}, {38, 57, 69, 72}, {49, 60, 68, 73}, {55, 61, 73, 75}, {44, 62, 68, 72}, {50, 61, 66, 71}, {45, 60, 69, 77}, {52, 67, 66, 71}, {44, 62, 67, 73}, {47, 61, 69, 71}, {48, 61, 61, 71}, {41, 61, 69, 73}, {45, 63, 69, 72}, {40, 61, 70, 74}, {43, 62, 71, 73}, {44, 70, 71, 73}, {44, 62, 68, 74}, {42, 61, 62, 69}, {43, 59, 70, 73}, {41, 61, 68, 63}, {48, 62, 68, 75}, {45, 63, 70, 67}, {49, 63, 72, 69}, {41, 68, 70, 77}, {39, 60, 66, 78}, {40, 63, 70, 71}, {45, 68, 70, 70}, {44, 61, 69, 75}, {49, 66, 68, 71}, {41, 61, 66, 71}, {48, 63, 69, 71}, {41, 60, 69, 76}, {49, 61, 69, 73}},
    {{47, 63, 76, 76}, {49, 73, 78, 76}, {51, 70, 76, 80}, {48, 68, 72, 78}, {47, 63, 73, 77}, {92, 68, 73, 81}, {45, 61, 70, 77}, {52, 63, 72, 78}, {45, 67, 68, 75}, {52, 71, 77, 77}, {50, 72, 76, 81}, {52, 69, 74, 78}, {48, 63, 71, 79}, {53, 68, 72, 76}, {45, 67, 72, 75}, {57, 62, 73, 79}, {48, 62, 69, 72}, {50, 73, 74, 79}, {51, 67, 74, 80}, {51, 69, 68, 79}, {49, 60, 76, 80}, {56, 70, 69, 80}, {48, 69, 71, 74}, {52, 72, 73, 75}, {50, 62, 67, 75}, {46, 73, 74, 76}, {52, 63, 69, 76}, {51, 63, 75, 79}, {48, 66, 72, 77}, {50, 71, 72, 77}, {42, 71, 70, 80}, {80, 70, 71, 75}, {47, 68, 72, 82}, {58, 70, 73, 81}, {47, 69, 70, 77}, {60, 60, 68, 71}, {47, 60, 69, 80}, {48, 72, 74, 78}, {59, 69, 73, 78}, {71, 68, 71, 80}, {43, 58, 72, 74}, {50, 70, 71, 75}, {59, 61, 75, 83}, {44, 70, 72, 77}, {56, 60, 69, 75}, {53, 71, 77, 80}, {48, 67, 67, 76}, {49, 73, 74, 79}, {51, 67, 70, 79}, {53, 69, 70, 78}, {44, 67, 70, 78}, {49, 69, 73, 80}, {44, 62, 73, 76}, {48, 63, 80, 79}, {48, 71, 70, 75}, {49, 71, 74, 75}, {46, 62, 68, 76}, {52, 70, 73, 81}, {40, 67, 73, 71}, {53, 70, 75, 82}, {50, 70, 69, 73}, {52, 67, 77, 76}, {43, 68, 70, 75}, {44, 69, 68, 78}, {41, 69, 75, 76}, {50, 73, 79, 77}, {47, 68, 76, 78}, {56, 73, 72, 77}, {45, 69, 74, 78}, {52, 71, 70, 78}, {44, 62, 72, 79}, {54, 69, 73, 76}},
    {{50, 68, 74, 79}, {50, 72, 81, 81}, {50, 72, 78, 81}, {49, 69, 73, 80}, {49, 67, 77, 78}, {94, 68, 76, 82}, {48, 62, 73, 81}, {53, 63, 74, 81}, {45, 62, 68, 73}, {52, 70, 81, 81}, {53, 74, 73, 79}, {52, 69, 76, 81}, {50, 68, 71, 82}, {51, 69, 74, 79}, {47, 66, 73, 79}, {58, 68, 74, 81}, {50, 68, 72, 74}, {53, 76, 75, 82}, {53, 66, 72, 80}, {51, 71, 72, 82}, {51, 67, 76, 80}, {57, 71, 72, 81}, {48, 69, 72, 78}, {52, 73, 78, 80}, {49, 62, 71, 77}, {49, 71, 80, 77}, {52, 71, 75, 80}, {52, 71, 78, 81}, {51, 66, 73, 82}, {52, 73, 75, 81}, {43, 71, 70, 83}, {70, 70, 72, 77}, {52, 68, 76, 82}, {61, 74, 75, 81}, {50, 69, 71, 79}, {61, 60, 76, 71}, {47, 60, 69, 82}, {50, 73, 79, 83}, {59, 74, 78, 80}, {50, 72, 70, 79}, {43, 58, 74, 78}, {55, 71, 73, 83}, {59, 62, 79, 80}, {47, 72, 77, 79}, {56, 61, 70, 76}, {46, 73, 81, 81}, {55, 69, 68, 78}, {51, 78, 75, 81}, {49, 63, 74, 80}, {53, 71, 72, 82}, {46, 61, 75, 79}, {49, 69, 76, 80}, {46, 67, 75, 81}, {47, 67, 73, 79}, {48, 75, 78, 83}, {53, 71, 74, 83}, {40, 69, 73, 72}, {51, 71, 80, 82}, {44, 71, 69, 74}, {50, 73, 80, 81}, {52, 67, 70, 78}, {50, 69, 79, 81}, {44, 68, 77, 78}, {50, 69, 73, 80}, {71, 72, 78, 80}, {51, 76, 78, 81}, {50, 70, 78, 80}, {54, 76, 75, 77}, {51, 69, 74, 79}, {52, 73, 76, 82}, {49, 67, 73, 78}, {52, 71, 77, 81}},
    {{49, 68, 74, 78}, {48, 73, 76, 81}, {52, 67, 80, 77}, {48, 61, 71, 79}, {47, 69, 77, 76}, {86, 68, 71, 81}, {48, 62, 72, 80}, {52, 63, 71, 78}, {44, 57, 69, 72}, {50, 72, 79, 76}, {54, 67, 77, 79}, {48, 62, 77, 81}, {52, 63, 71, 78}, {50, 67, 69, 76}, {44, 66, 73, 77}, {51, 61, 72, 76}, {49, 62, 72, 73}, {51, 73, 71, 80}, {53, 68, 71, 80}, {52, 71, 68, 81}, {50, 63, 73, 79}, {56, 71, 68, 79}, {45, 66, 73, 75}, {48, 67, 72, 76}, {53, 63, 72, 73}, {48, 69, 75, 77}, {51, 71, 71, 79}, {49, 63, 74, 80}, {41, 59, 72, 80}, {48, 68, 72, 80}, {41, 69, 69, 79}, {51, 68, 72, 76}, {41, 67, 72, 82}, {60, 71, 73, 80}, {49, 69, 70, 80}, {58, 57, 72, 72}, {48, 63, 70, 82}, {48, 69, 77, 74}, {59, 73, 71, 81}, {51, 70, 70, 79}, {44, 57, 71, 73}, {48, 67, 69, 79}, {58, 61, 76, 79}, {30, 69, 72, 75}, {58, 62, 66, 78}, {49, 71, 79, 80}, {50, 62, 68, 79}, {50, 71, 77, 79}, {51, 67, 73, 78}, {51, 66, 70, 78}, {42, 67, 69, 79}, {46, 68, 74, 78}, {33, 62, 69, 79}, {44, 67, 77, 72}, {47, 72, 70, 82}, {45, 71, 75, 81}, {48, 63, 68, 71}, {52, 68, 75, 77}, {42, 69, 74, 78}, {49, 71, 75, 80}, {47, 62, 69, 76}, {49, 67, 75, 75}, {43, 69, 73, 77}, {45, 67, 72, 79}, {42, 70, 73, 74}, {51, 73, 75, 79}, {50, 69, 73, 78}, {51, 71, 73, 78}, {47, 71, 73, 76}, {53, 72, 72, 78}, {45, 62, 71, 78}, {50, 69, 74, 77}},
    {{54, 73, 78, 83}, {57, 73, 79, 85}, {56, 71, 80, 83}, {58, 68, 78, 86}, {48, 74, 83, 83}, {92, 73, 78, 84}, {52, 69, 78, 84}, {52, 75, 81, 82}, {51, 62, 79, 82}, {55, 75, 83, 82}, {53, 74, 79, 84}, {52, 72, 81, 82}, {56, 78, 83, 83}, {57, 72, 80, 83}, {53, 78, 81, 84}, {56, 67, 73, 82}, {58, 73, 82, 83}, {58, 79, 75, 85}, {53, 74, 78, 85}, {52, 70, 75, 81}, {55, 71, 81, 83}, {60, 73, 74, 82}, {50, 75, 82, 85}, {55, 75, 80, 82}, {54, 72, 80, 83}, {58, 79, 77, 83}, {50, 73, 78, 80}, {53, 70, 77, 79}, {53, 70, 79, 86}, {54, 76, 81, 86}, {48, 78, 81, 86}, {59, 77, 78, 83}, {51, 76, 82, 83}, {63, 71, 77, 85}, {51, 76, 78, 86}, {68, 67, 81, 78}, {52, 72, 80, 84}, {52, 77, 83, 80}, {58, 75, 78, 86}, {49, 73, 74, 83}, {48, 61, 81, 81}, {51, 75, 78, 85}, {58, 68, 82, 78}, {54, 76, 79, 84}, {54, 74, 80, 81}, {59, 79, 84, 83}, {51, 75, 78, 86}, {57, 74, 79, 81}, {48, 77, 81, 80}, {57, 80, 76, 84}, {48, 70, 81, 82}, {50, 78, 81, 83}, {47, 69, 75, 82}, {52, 70, 82, 78}, {50, 76, 78, 87}, {48, 76, 72, 85}, {49, 72, 81, 78}, {54, 72, 81, 82}, {49, 75, 82, 82}, {54, 79, 82, 86}, {53, 68, 78, 82}, {51, 76, 78, 84}, {42, 79, 80, 82}, {48, 72, 82, 82}, {44, 77, 79, 84}, {56, 79, 80, 83}, {50, 73, 81, 83}, {55, 78, 80, 83}, {54, 73, 79, 83}, {59, 73, 78, 85}, {49, 74, 80, 84}, {58, 72, 81, 84}},
    {{57, 75, 78, 84}, {37, 78, 80, 87}, {58, 70, 80, 83}, {59, 75, 79, 86}, {53, 73, 82, 85}, {98, 80, 80, 86}, {55, 72, 79, 84}, {57, 77, 79, 83}, {53, 70, 80, 83}, {59, 78, 82, 85}, {56, 76, 81, 82}, {60, 74, 81, 85}, {52, 72, 82, 83}, {60, 81, 82, 83}, {56, 76, 82, 86}, {60, 71, 81, 84}, {57, 74, 79, 86}, {59, 81, 80, 91}, {57, 78, 82, 80}, {58, 75, 81, 83}, {53, 79, 82, 84}, {63, 79, 77, 85}, {55, 81, 83, 87}, {59, 77, 84, 84}, {56, 74, 81, 83}, {59, 81, 80, 84}, {53, 72, 79, 82}, {57, 71, 79, 81}, {55, 76, 80, 85}, {58, 81, 83, 85}, {49, 81, 83, 86}, {63, 81, 83, 87}, {53, 74, 83, 85}, {69, 76, 85, 86}, {59, 78, 78, 83}, {73, 72, 82, 81}, {53, 75, 81, 85}, {58, 81, 84, 85}, {60, 75, 78, 84}, {49, 77, 80, 84}, {48, 62, 81, 81}, {58, 80, 83, 85}, {63, 72, 83, 81}, {57, 82, 82, 84}, {58, 79, 79, 83}, {61, 82, 86, 84}, {56, 76, 83, 86}, {59, 76, 81, 81}, {54, 79, 84, 82}, {60, 83, 84, 85}, {48, 73, 80, 82}, {57, 74, 83, 82}, {49, 67, 76, 84}, {52, 79, 83, 86}, {58, 75, 82, 83}, {52, 79, 81, 84}, {51, 78, 82, 81}, {58, 75, 84, 85}, {49, 80, 83, 82}, {58, 81, 83, 85}, {58, 71, 81, 86}, {61, 73, 84, 88}, {44, 82, 81, 82}, {49, 78, 82, 82}, {50, 78, 82, 86}, {61, 83, 87, 85}, {55, 76, 78, 83}, {60, 81, 83, 83}, {56, 77, 82, 88}, {62, 76, 80, 87}, {54, 77, 80, 84}, {59, 75, 81, 85}},
    {{58, 74, 80, 86}, {60, 80, 82, 88}, {59, 73, 78, 84}, {63, 77, 82, 88}, {56, 75, 83, 85}, {101, 82, 82, 88}, {56, 71, 80, 85}, {58, 80, 82, 85}, {56, 76, 82, 84}, {61, 80, 84, 88}, {58, 79, 82, 83}, {59, 74, 82, 88}, {56, 79, 82, 83}, {58, 81, 83, 84}, {57, 74, 81, 86}, {59, 75, 81, 86}, {62, 73, 81, 83}, {62, 82, 81, 92}, {58, 80, 81, 86}, {58, 78, 82, 86}, {59, 79, 82, 84}, {70, 79, 79, 87}, {57, 79, 83, 86}, {58, 77, 84, 85}, {56, 75, 77, 85}, {59, 83, 81, 88}, {58, 72, 77, 82}, {59, 70, 81, 83}, {58, 80, 81, 86}, {60, 82, 84, 88}, {53, 80, 84, 88}, {61, 75, 82, 86}, {51, 81, 82, 85}, {63, 76, 83, 86}, {60, 77, 77, 87}, {70, 72, 85, 83}, {54, 79, 81, 90}, {60, 80, 86, 85}, {60, 77, 77, 86}, {56, 77, 81, 84}, {52, 67, 81, 84}, {59, 79, 82, 86}, {68, 75, 85, 83}, {55, 81, 82, 86}, {63, 79, 83, 85}, {67, 81, 84, 85}, {57, 80, 83, 85}, {56, 80, 82, 83}, {57, 76, 81, 84}, {58, 80, 84, 90}, {55, 75, 79, 82}, {57, 79, 84, 85}, {49, 74, 79, 83}, {58, 77, 85, 98}, {58, 81, 81, 86}, {53, 80, 82, 88}, {55, 76, 79, 81}, {57, 79, 80, 87}, {53, 80, 86, 84}, {61, 82, 85, 88}, {58, 73, 81, 84}, {63, 82, 84, 88}, {53, 79, 81, 84}, {51, 83, 84, 84}, {54, 75, 80, 86}, {59, 81, 84, 88}, {58, 78, 82, 82}, {61, 82, 81, 89}, {57, 78, 83, 85}, {63, 79, 80, 89}, {57, 74, 79, 86}, {61, 76, 82, 86}},
    {{57, 74, 81, 86}, {59, 81, 81, 86}, {59, 73, 82, 85}, {60, 74, 82, 90}, {57, 80, 83, 84}, {97, 82, 79, 88}, {54, 73, 80, 86}, {58, 80, 83, 86}, {54, 80, 81, 83}, {62, 80, 84, 87}, {59, 76, 81, 86}, {56, 77, 78, 89}, {47, 80, 85, 84}, {58, 81, 81, 85}, {58, 79, 84, 89}, {59, 74, 82, 85}, {62, 74, 82, 86}, {59, 80, 80, 90}, {58, 78, 82, 85}, {53, 76, 80, 86}, {60, 82, 82, 83}, {63, 78, 81, 86}, {57, 80, 81, 86}, {58, 76, 83, 85}, {59, 78, 81, 86}, {59, 83, 81, 88}, {58, 75, 81, 84}, {57, 75, 78, 85}, {57, 79, 82, 84}, {58, 81, 84, 86}, {53, 80, 85, 88}, {63, 76, 82, 87}, {48, 80, 85, 86}, {62, 76, 82, 88}, {60, 81, 80, 89}, {71, 71, 83, 84}, {54, 82, 80, 86}, {60, 77, 83, 84}, {61, 78, 80, 86}, {57, 78, 80, 90}, {53, 67, 84, 82}, {57, 80, 83, 87}, {68, 75, 85, 85}, {53, 80, 85, 89}, {69, 80, 79, 82}, {61, 83, 86, 85}, {55, 78, 85, 87}, {58, 81, 83, 86}, {57, 76, 82, 84}, {89, 78, 83, 87}, {58, 80, 82, 82}, {50, 73, 84, 83}, {56, 81, 81, 85}, {56, 78, 82, 84}, {59, 82, 84, 91}, {56, 74, 82, 89}, {51, 80, 80, 83}, {58, 80, 83, 86}, {54, 80, 84, 83}, {59, 81, 83, 84}, {59, 79, 82, 89}, {61, 82, 85, 88}, {53, 77, 84, 83}, {52, 81, 83, 81}, {52, 80, 83, 90}, {60, 83, 82, 89}, {58, 79, 83, 83}, {60, 83, 82, 87}, {57, 78, 82, 86}, {62, 76, 81, 89}, {56, 79, 80, 86}, {59, 76, 82, 86}},
    {{60, 81, 83, 93}, {68, 82, 83, 97}, {60, 82, 84, 93}, {62, 82, 82, 95}, {59, 83, 85, 91}, {106, 82, 83, 93}, {56, 81, 85, 99}, {61, 80, 83, 90}, {58, 83, 80, 92}, {62, 82, 83, 94}, {61, 83, 85, 91}, {61, 82, 85, 96}, {58, 81, 84, 92}, {60, 81, 82, 93}, {58, 83, 86, 92}, {63, 79, 83, 95}, {61, 82, 83, 90}, {62, 86, 81, 97}, {58, 81, 86, 92}, {58, 81, 81, 90}, {67, 82, 85, 98}, {66, 84, 82, 92}, {58, 81, 82, 94}, {61, 84, 84, 92}, {60, 81, 82, 92}, {61, 82, 85, 94}, {59, 83, 84, 94}, {62, 81, 86, 92}, {58, 83, 83, 94}, {59, 80, 84, 93}, {54, 83, 85, 92}, {66, 76, 82, 92}, {52, 82, 86, 95}, {72, 82, 83, 95}, {58, 83, 82, 94}, {70, 74, 83, 86}, {55, 84, 82, 92}, {60, 82, 84, 89}, {70, 83, 83, 99}, {58, 83, 82, 99}, {59, 77, 84, 90}, {56, 81, 85, 92}, {71, 83, 86, 94}, {58, 79, 82, 92}, {68, 84, 83, 94}, {61, 81, 81, 89}, {58, 81, 86, 93}, {62, 84, 87, 93}, {60, 84, 84, 90}, {58, 82, 83, 89}, {56, 79, 80, 95}, {55, 79, 86, 92}, {61, 82, 83, 91}, {58, 81, 83, 89}, {58, 82, 85, 95}, {56, 84, 83, 94}, {57, 80, 82, 92}, {59, 80, 84, 92}, {59, 78, 86, 96}, {61, 79, 86, 91}, {61, 82, 85, 94}, {58, 81, 83, 95}, {58, 82, 82, 90}, {58, 79, 81, 89}, {49, 82, 85, 96}, {59, 82, 85, 90}, {60, 83, 85, 92}, {58, 81, 82, 89}, {60, 83, 83, 93}, {58, 82, 84, 94}, {58, 80, 84, 91}, {60, 80, 83, 90}},
    {{61, 86, 89, 99}, {70, 86, 88, 100}, {67, 86, 91, 101}, {62, 84, 85, 99}, {60, 87, 91, 94}, {102, 86, 89, 101}, {60, 85, 89, 100}, {67, 85, 86, 97}, {55, 84, 90, 96}, {70, 82, 87, 96}, {59, 85, 92, 95}, {68, 84, 89, 98}, {57, 86, 91, 100}, {61, 82, 90, 99}, {58, 87, 89, 100}, {67, 84, 88, 98}, {62, 82, 89, 93}, {62, 88, 86, 95}, {61, 85, 91, 102}, {60, 87, 87, 95}, {67, 85, 90, 98}, {71, 84, 87, 96}, {60, 88, 85, 96}, {70, 88, 90, 101}, {59, 87, 87, 91}, {62, 89, 91, 100}, {60, 84, 86, 95}, {67, 89, 90, 102}, {58, 87, 88, 94}, {61, 84, 90, 97}, {58, 90, 89, 97}, {69, 83, 86, 93}, {57, 88, 90, 97}, {75, 85, 88, 101}, {60, 86, 88, 97}, {72, 82, 88, 94}, {55, 87, 85, 99}, {63, 88, 90, 97}, {73, 83, 84, 100}, {58, 88, 90, 96}, {58, 84, 88, 95}, {59, 86, 92, 99}, {76, 86, 88, 99}, {60, 83, 88, 96}, {69, 87, 86, 100}, {61, 87, 91, 90}, {60, 81, 88, 100}, {61, 88, 90, 95}, {62, 85, 90, 99}, {61, 86, 86, 95}, {57, 83, 84, 97}, {61, 86, 89, 91}, {58, 83, 85, 96}, {55, 86, 89, 90}, {61, 82, 86, 106}, {53, 90, 90, 97}, {60, 82, 90, 94}, {60, 85, 88, 100}, {59, 84, 92, 97}, {71, 84, 86, 96}, {57, 86, 85, 99}, {62, 85, 87, 100}, {54, 85, 87, 94}, {56, 84, 86, 97}, {59, 86, 90, 99}, {62, 89, 90, 100}, {59, 86, 88, 93}, {58, 85, 89, 96}, {62, 87, 84, 96}, {63, 87, 89, 97}, {59, 84, 86, 101}, {61, 84, 89, 97}},
    {{62, 86, 91, 97}, {72, 89, 93, 102}, {66, 92, 95, 102}, {59, 86, 90, 103}, {60, 87, 95, 95}, {105, 87, 92, 103}, {60, 86, 92, 100}, {68, 88, 91, 99}, {59, 87, 87, 99}, {54, 89, 93, 100}, {58, 88, 95, 97}, {62, 87, 94, 96}, {60, 91, 94, 98}, {63, 89, 94, 103}, {51, 90, 90, 100}, {70, 92, 93, 103}, {52, 82, 91, 91}, {62, 92, 94, 98}, {63, 90, 95, 103}, {62, 93, 97, 91}, {70, 87, 90, 101}, {76, 93, 92, 100}, {60, 88, 92, 100}, {72, 91, 92, 102}, {62, 91, 90, 98}, {67, 94, 93, 102}, {63, 90, 91, 98}, {63, 92, 92, 103}, {61, 89, 93, 100}, {66, 90, 92, 102}, {58, 90, 95, 99}, {69, 86, 87, 90}, {58, 87, 92, 101}, {81, 90, 93, 103}, {62, 89, 93, 101}, {75, 88, 90, 97}, {59, 92, 91, 94}, {62, 92, 93, 100}, {80, 85, 91, 101}, {58, 89, 96, 103}, {58, 88, 90, 92}, {63, 90, 98, 97}, {73, 89, 96, 100}, {53, 87, 88, 98}, {72, 89, 88, 96}, {60, 88, 92, 96}, {63, 87, 92, 101}, {58, 91, 91, 99}, {66, 86, 98, 99}, {61, 88, 89, 100}, {63, 86, 89, 97}, {59, 83, 87, 99}, {59, 85, 91, 90}, {59, 89, 98, 97}, {62, 85, 89, 104}, {55, 91, 90, 99}, {60, 84, 89, 96}, {70, 87, 92, 101}, {61, 89, 96, 101}, {56, 88, 94, 103}, {63, 89, 96, 92}, {68, 91, 94, 96}, {58, 88, 89, 101}, {60, 86, 89, 102}, {60, 88, 91, 100}, {67, 92, 96, 99}, {59, 88, 88, 97}, {60, 90, 89, 101}, {63, 89, 91, 95}, {68, 89, 92, 100}, {61, 88, 91, 101}, {61, 85, 88, 100}},
    {{59, 85, 92, 0}, {73, 83, 90, 0}, {70, 86, 95, 0}, {72, 82, 87, 0}, {76, 85, 94, 0}, {70, 85, 88, 0}, {80, 80, 93, 0}, {75, 84, 88, 0}, {69, 83, 93, 0}, {80, 86, 90, 0}, {66, 82, 95, 0}, {77, 82, 94, 0}, {62, 85, 94, 0}, {72, 83, 89, 0}, {63, 83, 90, 0}, {75, 86, 93, 0}, {70, 81, 90, 0}, {71, 88, 91, 0}, {76, 83, 92, 0}, {77, 85, 92, 0}, {79, 83, 93, 0}, {80, 85, 92, 0}, {76, 85, 88, 0}, {74, 87, 92, 0}, {78, 84, 93, 0}, {79, 87, 92, 0}, {71, 85, 91, 0}, {80, 84, 90, 0}, {81, 85, 94, 0}, {79, 82, 90, 0}, {75, 88, 92, 0}, {75, 82, 88, 0}, {74, 82, 94, 0}, {80, 85, 89, 0}, {79, 85, 94, 0}, {73, 84, 89, 0}, {78, 86, 95, 0}, {76, 86, 90, 0}, {75, 83, 90, 0}, {78, 85, 90, 0}, {75, 84, 96, 0}, {69, 82, 95, 0}, {75, 84, 95, 0}, {76, 83, 89, 0}, {78, 80, 92, 0}, {70, 82, 91, 0}, {58, 84, 88, 0}, {73, 87, 92, 0}, {71, 80, 98, 0}, {62, 85, 88, 0}, {61, 81, 91, 0}, {71, 84, 87, 0}, {76, 72, 88, 0}, {63, 85, 92, 0}, {78, 80, 86, 0}, {70, 85, 98, 0}, {69, 85, 93, 0}, {81, 82, 92, 0}, {74, 85, 95, 0}, {69, 84, 85, 0}, {80, 82, 98, 0}, {76, 83, 90, 0}, {70, 82, 86, 0}, {75, 82, 90, 0}, {74, 85, 91, 0}, {72, 87, 96, 0}, {73, 82, 86, 0}, {74, 82, 89, 0}, {62, 85, 92, 0}, {72, 82, 91, 0}, {77, 84, 89, 0}, {72, 81, 89, 0}}};

  TF1 *f1 = new TF1("f1","TMath::Landau(x,[0],[1],0)",-5,10);
  f1->SetParameters(0,1);
  double Landau01_turnOn = f1->GetX(0.12,-3.0,-1.0);
  std::cout << Landau01_turnOn << std::endl;

  std::vector<int> laserList;

  Long64_t nbytes = 0, nb = 0;
  for (Long64_t jentry=0; jentry<nentries;jentry++) {
    Long64_t ientry = LoadTree(jentry);
    if (ientry < 0) break;
    nb = fChain->GetEntry(jentry);   nbytes += nb;
    
    if (((jentry+1) % 1000) == 0) std::cout << "Processing event " << jentry+1 << "/" << nentries << std::endl;
    //if (laserType == 999) continue; // this is when settings on the front end are changed
    //    std::cout << laserType << " = laserType" << std::endl;
    if (!(std::find(laserList.begin(), laserList.end(), laserType) != laserList.end())) { // if item found in list, no need to add
      laserList.push_back(laserType);
      for (int i=0; i<laserList.size(); i++) std::cout << laserList[i] << " " << std::endl;
    }
  
    // for a single event, determine at what ieta, iphi the TDC=0 is set. Match this with the FG1
    // have to do delta R matching to get QIE channels since are different from TP channels, like for (int ch = 0; ch < QIE11DigiIEta->size(); ++ch) {
    int QIE_TDC0_ieta_iphi[33][73] = {{}}; // by ieta, iphi, set this array value to TDC=0 TS if a cell in that tower has TDC=0
    for (int ieta = 0; ieta < 33; ieta ++) {
      for (int iphi = 0; iphi < 73; iphi ++) QIE_TDC0_ieta_iphi[ieta][iphi] = 9;
    }
    for (int ch = 0; ch < QIE11DigiIEta->size(); ++ch) {
      int ch_ieta = QIE11DigiIEta->at(ch);
      int ch_iphi = QIE11DigiIPhi->at(ch);
      int ch_depth = QIE11DigiDepth->at(ch);
      if (abs(ch_ieta) <= 16) {
	int QIE_TDC0_TS = -1;
	for (int QIE_TS = 0; QIE_TS < 8; QIE_TS++) {
	  // find first TS where TDC = 0
	  if (QIE11DigiTDC->at(ch).at(QIE_TS) == 0 && QIE_TDC0_TS == -1) {
	    QIE_TDC0_TS = QIE_TS;
	    //    std::cout << QIE_TDC0_TS << " = TS where QIE digi TDC=0 at ieta, iphi = " << ch_ieta << ", " << ch_iphi << " for event number = " << jentry << std::endl;
	    if (ch_ieta > 0) QIE_TDC0_ieta_iphi[ch_ieta][ch_iphi] = QIE_TS;
	    if (ch_ieta < 0) QIE_TDC0_ieta_iphi[ch_ieta+33][ch_iphi] = QIE_TS;
	  }
	}
      }
    }
    std::ofstream out ("Hcal_Events_0.txt", std::ios::app);
    if (out.is_open()){
    for (int ch = 0; ch < HcalTriggerPrimitiveIEta->size(); ++ch) {
      int TPieta = HcalTriggerPrimitiveIEta->at(ch);
      int TPiphi = HcalTriggerPrimitiveIPhi->at(ch);

      if (TPieta >= 9 && TPieta <= 12 && TPiphi == 53) continue; // skip the towers where ieta is 9-12 and iphi is 53, as this is where fine grain bits are set all over the place, without corresponding TDC
      if (abs(TPieta) > 16 && abs(TPieta) < 29) {
	int fg0 = HcalTriggerPrimitiveFineGrain0->at(ch).at(2);
        int fg1 = HcalTriggerPrimitiveFineGrain1->at(ch).at(2);
        int fg2 = HcalTriggerPrimitiveFineGrain2->at(ch).at(2);
        int fg3 = HcalTriggerPrimitiveFineGrain3->at(ch).at(2);
        int fg4 = HcalTriggerPrimitiveFineGrain4->at(ch).at(2);
        int fg5 = HcalTriggerPrimitiveFineGrain5->at(ch).at(2);
	//if (fg0 + fg1 + fg2 + fg3 > 0) std::cout << "ieta = " << TPieta << " with fine grain bits set at " << fg0 << ", " << fg1 << ", " << fg2 << ", " << fg3 << std::endl;
      }

      if (abs(TPieta) <= 29) {
	if (FB1_by_TS.find(TPieta) == FB1_by_TS.end()) FB1_by_TS[TPieta] = new TH1F(Form("FB1_byTS_ieta%d",TPieta),Form("Prompt finegrain bit (1) by QIE delay;QIE Relative Shift (ns);Prompt finegrain bits"),11,-2,9);
        if (FB2_by_TS.find(TPieta) == FB2_by_TS.end()) FB2_by_TS[TPieta] = new TH1F(Form("FB2_byTS_ieta%d",TPieta),Form("Delay 1 finegrain bit (2) by QIE delay;QIE Relative Shift (ns);Delay 1 finegrain bits"),11,-2,9);
        if (FB3_by_TS.find(TPieta) == FB3_by_TS.end()) FB3_by_TS[TPieta] = new TH1F(Form("FB3_byTS_ieta%d",TPieta),Form("Delay 2 finegrain bit (3) by QIE delay;QIE Relative Shift (ns);Delay 2 finegrain bits"),11,-2,9);
	if (Tower_valid.find(TPieta) == Tower_valid.end()) Tower_valid[TPieta] = new TH1F(Form("Tower_valid_ieta%d",TPieta),Form("Tower with valid energy in ieta=%d;QIE Relative Shift (ns);Fraction of Towers",TPieta),11,-2,9);
	if (h1_fg1.find(TPieta) == h1_fg1.end()) h1_fg1[TPieta] = new TH1F(Form("FG1_eff_ieta%d",TPieta),Form("Prompt efficiency;QIE Relative Shift (ns);Finegrain bit fraction"),11,-2,9);
        if (h1_fg2.find(TPieta) == h1_fg2.end()) h1_fg2[TPieta] = new TH1F(Form("FG2_eff_ieta%d",TPieta),Form("Delay1 efficiency;QIE Relative Shift (ns);Finegrain bit fraction"),11,-2,9);
        if (h1_fg3.find(TPieta) == h1_fg3.end()) h1_fg3[TPieta] = new TH1F(Form("FG3_eff_ieta%d",TPieta),Form("Delay2 efficiency;QIE Relative Shift (ns);Finegrain bit fraction"),11,-2,9);

	//	for (int TS = 0; TS < 4; TS++) {
	int TS = 2;
	float totalEnergy = HcalTriggerPrimitiveCompressedEt->at(ch).at(TS);
	int fg0 = HcalTriggerPrimitiveFineGrain0->at(ch).at(TS);
	int fg1 = HcalTriggerPrimitiveFineGrain1->at(ch).at(TS);
	int fg2 = HcalTriggerPrimitiveFineGrain2->at(ch).at(TS);
	int fg3 = HcalTriggerPrimitiveFineGrain3->at(ch).at(TS);
	int fg4 = HcalTriggerPrimitiveFineGrain4->at(ch).at(TS);
	int fg5 = HcalTriggerPrimitiveFineGrain5->at(ch).at(TS);
	float energy = HcalTriggerPrimitiveCompressedEt->at(ch).at(TS);
	  	    
	if (fg0 || (!fg1 && (fg2 || fg3))) std::cout << "HC Event " << jentry << ": flagged HCAL TP tower based on FG logic (" << fg0 << fg1 << fg2 << fg3<< "), with TP ieta, iphi " << TPieta << ", " << TPiphi << " Energy " << energy << std::endl;
	if ((fg0 + fg1 + fg2 + fg3 ) > 0) std::cout << "HC Event " << jentry << ": HCAL TP tower with set FG bits (" << fg0 << fg1 << fg2 << fg3<<"), with TP ieta, iphi " << TPieta << ", " << TPiphi << " Energy " << energy << std::endl;
	if ((fg0 + fg1 + fg2 + fg3 ) > 0) out << "HC Event " << jentry << ": HCAL TP tower with set FG bits (" << fg0 << fg1 << fg2 << fg3<< "), with TP ieta, iphi " << TPieta << ", " << TPiphi << " Energy " << energy << std::endl;
	if (fg0 || (!fg1 && (fg2 || fg3))) out << "HC Event " << jentry << ": flagged HCAL TP tower based on FG logic (" << fg0 << fg1 << fg2 << fg3<< "), with TP ieta, iphi " << TPieta << ", " << TPiphi << " Energy " << energy << std::endl;
	if (fg1 == 1) FB1_by_TS[TPieta]->Fill(laserType,1);
	if (fg2 == 1) FB2_by_TS[TPieta]->Fill(laserType,1);
	if (fg3 == 1) FB3_by_TS[TPieta]->Fill(laserType,1);
	if (totalEnergy > 4) Tower_valid[TPieta]->Fill(laserType,1); // is total energy in GeV? this is compressed ET, so already linearized or not yet. might make more sense to require >4 gev to have a realistic energy threshold on the tower

	//	} // end TS loop
      } // end HB loop
    } // end channel loop
  
    for (int ch = 0; ch < QIE11DigiIEta->size(); ++ch) {
      int ch_ieta = QIE11DigiIEta->at(ch); // abs(QIE11DigiIEta->at(ch));
      int ch_iphi = QIE11DigiIPhi->at(ch);
      int ch_depth = QIE11DigiDepth->at(ch);
      
      if (abs(ch_ieta) <= 16) {
	if (abs(ch_ieta) == 16 && QIE11DigiDepth->at(ch) == 4) continue;

	if (HB_cell_valid[ch_ieta].find(ch_depth) == HB_cell_valid[ch_ieta].end()) HB_cell_valid[ch_ieta][ch_depth] = new TH1F(Form("HB_cell_valid_ieta%d_depth%d",ch_ieta,ch_depth),"Valid cell;QIE Relative Shift (ns);Fraction of Events",11,-2,9);	

	if ((QIE11DigiADC->at(ch).at(3) > ADC_xml_decoded[ch_ieta - 1][ch_iphi-1][ch_depth - 1] && ch_ieta > 0) || (QIE11DigiADC->at(ch).at(3) > ADC_xml_decoded[ch_ieta * -1 + 16 - 1][ch_iphi-1][ch_depth - 1] && ch_ieta < 0)) {
	  if (QIE11DigiTDC->at(ch).at(3) < 3) std::cout << "HC Event " << jentry << ": with QIE11 digi TDC = " << QIE11DigiTDC->at(ch).at(3) << " at ieta, iphi, depth = " << ch_ieta << ", " << ch_iphi << ", " << ch_depth << std::endl;
	  if (QIE11DigiTDC->at(ch).at(3) < 3) out << "HC Event " << jentry << ": with QIE11 digi TDC = " << QIE11DigiTDC->at(ch).at(3) << " at ieta, iphi, depth = " << ch_ieta << ", " << ch_iphi << ", " << ch_depth << std::endl;
	  HB_cell_valid[ch_ieta][ch_depth]->Fill(laserType,1); // just fill if cell > 4 GeV (in SOI)

	  if (HB_landau_fit[laserType][ch_ieta].find(ch_depth) == HB_landau_fit[laserType][ch_ieta].end()) HB_landau_fit[laserType][ch_ieta][ch_depth] = new TH1D(Form("HB_landau_delay%d_ieta%d_depth%d",laserType,ch_ieta,ch_depth),Form("Landau result, QIE=%d, i#eta=%d, depth=%d;fit result;Fraction of pulses",laserType,ch_ieta,ch_depth),25,1.5,4);
	  TH1F* HB_energy_byTS_landau = new TH1F(Form("HB_pulseShapeFit_ieta%d_depth%d_iphi%d_event%d",QIE11DigiIEta->at(ch),ch_depth,ch_iphi,jentry),Form("Pulse Shape Fit, i#eta=%d, depth=%d;TS;Fraction of Energy",ch_ieta,ch_depth),8,0,8);

          int maxTS = 0;
          for (int TS = 0; TS < 8; TS++) {
            if (QIE11DigiADC->at(ch).at(TS) > QIE11DigiADC->at(ch).at(maxTS)) maxTS = TS;
            HB_energy_byTS_landau->Fill(TS, QIE11DigiADC->at(ch).at(TS));
          }

          TF1* fit1 = new TF1("fit_landau","landau",maxTS-1,maxTS+3);
          HB_energy_byTS_landau->Fit(fit1,"QRL+");
	  HB_landau_fit[laserType][ch_ieta][ch_depth]->Fill(fit1->GetParameter(1)  + fit1->GetParameter(2) * Landau01_turnOn);	  

	  for (int TS = 2; TS < 4; TS++) {
	    for (int TDC = 0; TDC < 4; TDC++) {
	      if (HB_TDC_byScan[TS][TDC][ch_ieta].find(ch_depth) == HB_TDC_byScan[TS][TDC][ch_ieta].end()) HB_TDC_byScan[TS][TDC][ch_ieta][ch_depth] = new TH1F(Form("HB_TS%d_%dTDC_byScan_ieta%d_depth%d",TS,TDC,ch_ieta,ch_depth),Form("TDC=%d (TS=%d);QIE Relative Shift (ns);Fraction of Events",TDC,TS),11,-2,9);
	      if (HB_TDC_byScan_effs[TS][TDC][ch_ieta].find(ch_depth) == HB_TDC_byScan_effs[TS][TDC][ch_ieta].end()) HB_TDC_byScan_effs[TS][TDC][ch_ieta][ch_depth] = new TH1F(Form("HB_TS%d_%dTDC_byScan_effs_ieta%d_depth%d",TS,TDC,ch_ieta,ch_depth),Form("TDC=%d (TS=%d);QIE Relative Shift (ns);Fraction of Events",TDC,TS),11,-2,9);
	    
	    // TDC vs QIE delay, only looking at TDC and ADC information from TS3 in QIE11 digis 
	      if (QIE11DigiTDC->at(ch).at(TS) == TDC) HB_TDC_byScan[TS][TDC][ch_ieta][ch_depth]->Fill(laserType,1);
	    } // end TDC loop
	  } // end TS loop (2,3,4)
	} // end of 4 GeV requirement
      } // end HB loop
    } // end channel loop
    } // end out
    out<<std::endl;
    out.close();
  }
  
  TFile file_out(Form("hcal_histograms_13tev_QIE_plotByQIE.root"),"RECREATE");

  TString cmsLabel = "#scale[1.0]{#bf{CMS}} #scale[0.8]{#it{2022 13.6 TeV Collisions}}";
  float commentaryXpos = 0.6;
  float depthXpos = 0.2;

  // colors used = 9 (dark blue), 30 (green), 38 (blue), 40 (purple), 42 (orange / tan), 45/46/47 (red), 49 (muave)
  // average pulse shape in HB
  TCanvas *cHB_pulse_shape;

  //  HB_energy_byTS
  //  for (int ieta = -16; ieta <= 16; ieta++) {
  for (int ieta = 1; ieta <= 16; ieta++) { // to combine plots by ieta, use this and above "int ch_ieta = abs(QIE11DigiIEta->at(ch));" for the QIE11 channels
    if (ieta == 0) continue;

    // results from the landau fits
    TCanvas *cHB_pulse_shape;
    for (int laser = -2; laser <= 8; laser += 2) {
      TCanvas *cHB_pulse_4 = new TCanvas("c","c",3200,600);
      cHB_pulse_4->Divide(4,1,0.01,0.01);
      for (std::map<int,TH1D*>::iterator it = HB_landau_fit[laser][ieta].begin() ; it != HB_landau_fit[laser][ieta].end(); it++) {
	cHB_pulse_shape = new TCanvas(); // reset canvas
	HB_landau_fit[laser][ieta][it->first]->Scale(1/HB_landau_fit[laser][ieta][it->first]->Integral());
	if (HB_landau_fit[laser][ieta][it->first]->GetEntries() == 0) continue;
	HB_landau_fit[laser][ieta][it->first]->SetFillColor(40);
	HB_landau_fit[laser][ieta][it->first]->Draw("bar1");
	HB_landau_fit[laser][ieta][it->first]->Write();
	HB_landau_fit[laser][ieta][it->first]->SetMaximum(1);
	HB_landau_fit[laser][ieta][it->first]->SetMinimum(0.);

	TF1* fit2 = new TF1("fit_gaus","gaus",2,3.5);

	if (it->first == 1) HB_landau_fit[laser][ieta][it->first]->Fit(fit2,"QRL+","",2.5,3.5); // gaussian fit has three parameters. 0: height at peak, 2: position of center of peak, 3: standard deviation (width)
	if (it->first != 1) HB_landau_fit[laser][ieta][it->first]->Fit(fit2,"QRL+");
	fit2->Draw();
	std::cout << "delay = " << laser << ", ieta = " << ieta << ", depth = " << it->first << ", gaussian peak = " << fit2->GetParameter(0) << ", gaussian mean = " << fit2->GetParameter(1) << ", stdev = " << fit2->GetParameter(2) << std::endl;

	gStyle->SetOptStat(1100);
	gPad->Update();
	cHB_pulse_4->cd(it->first);
	HB_landau_fit[laser][ieta][it->first]->SetTitle("");
	HB_landau_fit[laser][ieta][it->first]->Draw("bar1");
	HB_landau_fit[laser][ieta][it->first]->Write();
	latex->DrawLatex(depthXpos, 0.75, Form("#scale[0.8]{depth=%d}",it->first));
	latex->DrawLatex(depthXpos, 0.65, Form("#scale[0.8]{Gaussian mean=%.3f}",fit2->GetParameter(1)));
	if (it->first == 2) latex->DrawLatex(0, 0.95, Form("#scale[1.2]{Landau Pulse Shape, i#eta=%d, QIE delay %d}",ieta,laser));	
	gPad->Update();
      }
      latex->DrawLatex(0.35, 0.95, cmsLabel);
      cHB_pulse_4->SaveAs(Form("2022_plots_relativeScan_Aug_xmlDecode/Landau/HB_LandauFit_QIE%d_ieta%d_2022_13tev.png",laser,ieta));
    } // end loop over QIE delay settings

    for (int depth = 1; depth <= 4; depth ++) {
      if (ieta == 16 && depth == 4) continue;
      //      for (int i=0; i<laserList.size(); i++) std::cout << "HB_cell_valid for ieta = " << ieta << ", depth = " << depth << ", and for QIE delay setting of " << laserList[i] << " is = " << HB_cell_valid[ieta][depth]->GetBinContent(laserList[i]+3) << std::endl;
    }

    for (int TS = 2; TS < 4; TS++) {
      for (int TDC = 0; TDC < 4; TDC++) {
      
	TCanvas *cHB_promptTDC_4 = new TCanvas("c","c",3200,600); // reset canvas
	cHB_promptTDC_4->Divide(4,1,0.01,0.01);
	for (std::map<int,TH1F*>::iterator it = HB_TDC_byScan[TS][TDC][ieta].begin() ; it != HB_TDC_byScan[TS][TDC][ieta].end(); it++) { // it->first is depth, it->second is TH1F HB_TDC_byScan[TDC]
	  cHB_pulse_shape = new TCanvas(); // reset canvas
	  if (TEfficiency::CheckConsistency(*it->second,*HB_cell_valid[ieta][it->first])) {
	    TEfficiency *effHB = new TEfficiency(*it->second,*HB_cell_valid[ieta][it->first]);
	    for (int i=0; i<laserList.size(); i++) HB_TDC_byScan_effs[TS][TDC][ieta][it->first]->Fill(laserList[i],effHB->GetEfficiency(laserList[i]+3)); // HB_TDC_byScan_effs is now the efficiencies of each TDC, compared to any cell over 4 GeV
	  }
	  
	  HB_TDC_byScan[TS][TDC][ieta][it->first]->Scale(1/HB_TDC_byScan[TS][TDC][ieta][it->first]->Integral()); // this is normalized to the distribution of this TDC value across each TS
	  if (HB_TDC_byScan[TS][TDC][ieta][it->first]->GetEntries() == 0) continue;
	  if (TDC==0) HB_TDC_byScan[TS][TDC][ieta][it->first]->SetFillColor(40);
	  if (TDC==1) HB_TDC_byScan[TS][TDC][ieta][it->first]->SetFillColor(38);
	  if (TDC==2) HB_TDC_byScan[TS][TDC][ieta][it->first]->SetFillColor(30);
	  if (TDC==3) HB_TDC_byScan[TS][TDC][ieta][it->first]->SetFillColor(45);
	  HB_TDC_byScan[TS][TDC][ieta][it->first]->Draw("bar1");
	  HB_TDC_byScan[TS][TDC][ieta][it->first]->Write();
	  HB_TDC_byScan[TS][TDC][ieta][it->first]->SetMaximum(1);
	  HB_TDC_byScan[TS][TDC][ieta][it->first]->SetMinimum(0.);
	  latex->DrawLatex(0.12, 0.85, cmsLabel);
	  latex->DrawLatex(commentaryXpos + 0.1, 0.65, Form("#scale[0.8]{i#eta=%d, depth=%d}",ieta,it->first));
	  gPad->Update();
	  cHB_promptTDC_4->cd(it->first);
	  HB_TDC_byScan[TS][TDC][ieta][it->first]->SetTitle("");
	  HB_TDC_byScan[TS][TDC][ieta][it->first]->Draw("bar1");
	  HB_TDC_byScan[TS][TDC][ieta][it->first]->Write();
	  latex->DrawLatex(depthXpos, 0.75, Form("#scale[0.8]{depth=%d}",it->first));
	  if (it->first == 2) latex->DrawLatex(0.2, 0.95, Form("#scale[1.2]{TDC=%d in HB, for i#eta=%d}",TDC,ieta));
	  gPad->Update();
	}
	latex->DrawLatex(0.5, 0.95, cmsLabel);
	cHB_promptTDC_4->SaveAs(Form("2022_plots_relativeScan_Aug_xmlDecode/ScanOffset/HB_TS%d_%dTDC_by_scanOffset_2022_13tev_ieta%d.png",TS,TDC,ieta));
      } // TDC loop

      TCanvas *cHB_stackedTDC = new TCanvas("c","c",3200,600);
      cHB_stackedTDC->Divide(4,1,0.01,0.01);
      //    THStack *hstack = new THStack("hstack","Efficiencies;QIE Relative Shift (ns);Fraction of each TDC code present");
      
      for (std::map<int,TH1F*>::iterator it = HB_TDC_byScan_effs[TS][0][ieta].begin() ; it != HB_TDC_byScan_effs[TS][0][ieta].end(); it++) { // it->first is depth, it->second is TH1F HB_TDC_byScan[TDC]
	THStack *hstack = new THStack("hstack",";QIE Relative Shift (ns);Fraction of each TDC code present");
	for (int TDC = 0; TDC < 4; TDC ++) {
	  if (TDC==0) HB_TDC_byScan_effs[TS][TDC][ieta][it->first]->SetFillColor(40);
	  if (TDC==1) HB_TDC_byScan_effs[TS][TDC][ieta][it->first]->SetFillColor(38);
	  if (TDC==2) HB_TDC_byScan_effs[TS][TDC][ieta][it->first]->SetFillColor(30);
	  if (TDC==3) HB_TDC_byScan_effs[TS][TDC][ieta][it->first]->SetFillColor(45);
	  HB_TDC_byScan_effs[TS][TDC][ieta][it->first]->SetFillStyle(1001);
	  HB_TDC_byScan_effs[TS][TDC][ieta][it->first]->SetTitle(Form("TDC=%d",TDC));
	  hstack->Add(HB_TDC_byScan_effs[TS][TDC][ieta][it->first]);
	}
	cHB_stackedTDC->cd(it->first);
	hstack->Draw("bar1");
	//      gPad->BuildLegend(0.75,0.72,0.95,0.92,"");
	
	latex->DrawLatex(commentaryXpos + 0.1, 0.65, Form("#scale[0.8]{depth=%d}",it->first));
	if (it->first == 2) latex->DrawLatex(0.2, 0.95, Form("#scale[1.2]{TDC Efficiencies in HB, TS=%d, i#eta=%d}",TS,ieta));
	gStyle->SetOptStat(0);
	gPad->Update();
      }
      latex->DrawLatex(0.5, 0.95, cmsLabel);
      cHB_stackedTDC->SaveAs(Form("2022_plots_relativeScan_Aug_xmlDecode/ScanOffset/TDC_by_ScanOffset_2022_13tev_TS%d_ieta%d.png",TS,ieta));
    } // TS loop 2,3,4
  } // ieta HB loop
    
  // QIE 11 digi
  TCanvas *cHB_promptFB;
  TCanvas *cHB_eff_ieta;
  
  // HB fine grain bits
  for (std::map<int,TH1F*>::iterator it = FB1_by_TS.begin() ; it != FB1_by_TS.end(); it++) { // it->first is ieta, it->second is FB1_by_TS
    cHB_promptFB = new TCanvas(); // reset canvas
    if (FB1_by_TS[it->first]->GetEntries() == 0) continue;
    
    FB1_by_TS[it->first]->SetFillColor(45);
    FB1_by_TS[it->first]->SetMinimum(0.);
    FB1_by_TS[it->first]->Draw("bar1");
    FB1_by_TS[it->first]->Write();
    
    latex->DrawLatex(0.12, 0.85, cmsLabel);
    latex->DrawLatex(commentaryXpos + 0.1, 0.65, Form("#scale[0.8]{i#eta=%d}",it->first));

    gPad->Update();
    cHB_promptFB->SaveAs(Form("2022_plots_relativeScan_Aug_xmlDecode/ScanOffset/FB1_by_scanOffset_2022_13tev_ieta%d.png",it->first));

    cHB_eff_ieta = new TCanvas(); // reset canvas
    if (TEfficiency::CheckConsistency(*it->second,*Tower_valid[it->first])) {
      TEfficiency *effHB = new TEfficiency(*it->second,*Tower_valid[it->first]);
      effHB->SetTitle(Form("Prompt (FG1) Rates in HB (ieta=%d)",it->first));
      effHB->SetLineWidth(2.);
      effHB->SetLineColor(kBlack);
      effHB->Draw();
      latex->DrawLatex(0.12, 0.85, cmsLabel);
      //      latex->DrawLatex(commentaryXpos - 0.45, 0.7, Form("#scale[0.8]{i#eta=%d}",it->first));
      gPad->Update();

      for (int i=0; i<laserList.size(); i++) h1_fg1[it->first]->Fill(laserList[i],effHB->GetEfficiency(laserList[i]+3)); // h1_fg1 is now the efficiencies of fg1 // +3 needed to shift laser (starting at -2) to bin 1
    }
    cHB_eff_ieta->SaveAs(Form("2022_plots_relativeScan_Aug_xmlDecode/ScanOffset/FB1_by_scanOffset_2022_13tev_ieta%d_fractional.png",it->first)); 
  }
  
  for (std::map<int,TH1F*>::iterator it = FB2_by_TS.begin() ; it != FB2_by_TS.end(); it++) { // it->first is ieta, it->second is FB2_by_TS
    cHB_promptFB = new TCanvas(); // reset canvas
    if (FB2_by_TS[it->first]->GetEntries() == 0) continue;
    
    FB2_by_TS[it->first]->SetFillColor(46);
    FB2_by_TS[it->first]->SetMinimum(0.);
    FB2_by_TS[it->first]->Draw("bar1");
    FB2_by_TS[it->first]->Write();
    
    latex->DrawLatex(0.12, 0.85, cmsLabel);
    latex->DrawLatex(commentaryXpos + 0.1, 0.65, Form("#scale[0.8]{i#eta=%d}",it->first));
    
    gPad->Update();
    cHB_promptFB->SaveAs(Form("2022_plots_relativeScan_Aug_xmlDecode/ScanOffset/FB2_by_scanOffset_2022_13tev_ieta%d.png",it->first));

    // % of tower with FG set
    cHB_eff_ieta = new TCanvas(); // reset canvas
    if (TEfficiency::CheckConsistency(*it->second,*Tower_valid[it->first])) {
      TEfficiency *effHB = new TEfficiency(*it->second,*Tower_valid[it->first]);
      effHB->SetTitle(Form("Delay 1 (FG2) Rates in HB (ieta=%d)",it->first));
      effHB->SetLineWidth(2.);
      effHB->SetLineColor(kBlack);
      effHB->Draw();
      latex->DrawLatex(0.12, 0.85, cmsLabel);
      //      latex->DrawLatex(commentaryXpos - 0.45, 0.7, Form("#scale[0.8]{i#eta=%d}",it->first));
      gPad->Update();
      //      effHB->GetPaintedGraph()->SetMaximum(1);
      //      effHB->GetPaintedGraph()->SetMinimum(0.99);
      for (int i=0; i<laserList.size(); i++) h1_fg2[it->first]->Fill(laserList[i],effHB->GetEfficiency(laserList[i]+3)); // h1_fg2 is now the efficiencies of fg2  
    }
    cHB_eff_ieta->SaveAs(Form("2022_plots_relativeScan_Aug_xmlDecode/ScanOffset/FB2_by_scanOffset_2022_13tev_ieta%d_fractional.png",it->first));
  }
  
  for (std::map<int,TH1F*>::iterator it = FB3_by_TS.begin() ; it != FB3_by_TS.end(); it++) { // it->first is ieta, it->second is FB3_by_TS
    cHB_promptFB = new TCanvas(); // reset canvas
    if (FB3_by_TS[it->first]->GetEntries() == 0) continue;
    
    FB3_by_TS[it->first]->SetFillColor(49);
    FB3_by_TS[it->first]->SetMinimum(0.);
    FB3_by_TS[it->first]->Draw("bar1");
    FB3_by_TS[it->first]->Write();
    
    latex->DrawLatex(0.12, 0.85, cmsLabel);
    latex->DrawLatex(commentaryXpos + 0.1, 0.65, Form("#scale[0.8]{i#eta=%d}",it->first));
    
    gPad->Update();
    cHB_promptFB->SaveAs(Form("2022_plots_relativeScan_Aug_xmlDecode/ScanOffset/FB3_by_scanOffset_2022_13tev_ieta%d.png",it->first));

    cHB_eff_ieta = new TCanvas(); // reset canvas
    if (TEfficiency::CheckConsistency(*it->second,*Tower_valid[it->first])) {
      TEfficiency *effHB = new TEfficiency(*it->second,*Tower_valid[it->first]);
      effHB->SetTitle(Form("Delay 2 (FG3) Rates in HB (ieta=%d)",it->first));
      effHB->SetLineWidth(2.);
      effHB->SetLineColor(kBlack);
      effHB->Draw();
      latex->DrawLatex(0.12, 0.85, cmsLabel);
      //      latex->DrawLatex(commentaryXpos - 0.45, 0.7, Form("#scale[0.8]{i#eta=%d}",it->first));
      gPad->Update();

      for (int i=0; i<laserList.size(); i++) h1_fg3[it->first]->Fill(laserList[i],effHB->GetEfficiency(laserList[i]+3)); // h1_fg3 is now the efficiencies of fg3
      //      for (int i=0; i<laserList.size(); i++) std::cout << "h1_fg3: " << laserList[i] << ", " << effHB->GetEfficiency(laserList[i]+3) << std::endl;
      //      for (int i=1; i<h1_fg3[it->first]->GetXaxis()->GetNbins(); i++) std::cout << h1_fg3[it->first]->GetBinContent(i) << std::endl;
    }
    cHB_eff_ieta->SaveAs(Form("2022_plots_relativeScan_Aug_xmlDecode/ScanOffset/FB3_by_scanOffset_2022_13tev_ieta%d_fractional.png",it->first));
  }
  TCanvas *cs;
  for (std::map<int,TH1F*>::iterator it = FB3_by_TS.begin() ; it != FB3_by_TS.end(); it++) { // it->first is ieta, it->second is FB3_by_TS
    THStack *hstack = new THStack("hstack","Efficiencies;QIE Relative Shift (ns);Fraction of each FG bit present");
    h1_fg1[it->first]->SetFillColor(40);
    h1_fg1[it->first]->SetFillStyle(1001);
    hstack->Add(h1_fg1[it->first]);
    h1_fg2[it->first]->SetFillColor(38);
    h1_fg2[it->first]->SetFillStyle(1001);
    hstack->Add(h1_fg2[it->first]);
    h1_fg3[it->first]->SetFillColor(30);
    h1_fg3[it->first]->SetFillStyle(1001);
    hstack->Add(h1_fg3[it->first]);
    hstack->SetMaximum(0.3);  
    cs = new TCanvas("cs","cs");
    latex->DrawLatex(0.12, 0.85, cmsLabel);
    latex->DrawLatex(commentaryXpos - 0.5, 0.7, Form("#scale[0.8]{i#eta=%d}",it->first));
    gPad->Update();
    hstack->Draw("bar");
    hstack->SetTitle(Form("FG Efficiencies in HB (ieta=%d)",it->first));
    hstack->GetXaxis()->SetTitle("Relative QIE Offset (ns)");
    hstack->GetYaxis()->SetTitle("Fraction of towers with FG bit set");
    gPad->BuildLegend(0.75,0.72,0.95,0.92,"");
    latex->DrawLatex(0.12, 0.85, cmsLabel);
    gPad->Update();
    cs->SaveAs(Form("2022_plots_relativeScan_Aug_xmlDecode/ScanOffset/FB_by_scanOffset_2022_13tev_ieta%d_fractionalOverlay.png",it->first));
  }
}
